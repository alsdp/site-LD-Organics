<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>LD Organics - Plateforme d'achat</title>
<!-- Google Font -->
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
<!-- Font Awesome pour les icÃ´nes -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
:root {
    --primary: #2d5016;
    --primary-light: #3a6720;
    --secondary: #4a7c2a;
    --accent: #7cb342;
    --accent-light: #8bc34a;
    --light: #f8f9fa;
    --light-gray: #e9ecef;
    --dark: #2d2d2d;
    --dark-gray: #6c757d;
    --warning: #ff9800;
    --error: #f44336;
    --success: #4caf50;
    --gradient: linear-gradient(135deg, var(--primary), var(--secondary));
    --shadow: 0 4px 20px rgba(0,0,0,0.08);
    --shadow-hover: 0 8px 30px rgba(0,0,0,0.12);
    --radius: 12px;
    --radius-sm: 8px;
    --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: 'Inter', sans-serif;
    line-height: 1.7;
    color: var(--dark);
    background: linear-gradient(rgba(248, 249, 250, 0.9), rgba(233, 236, 239, 0.9)), 
                url('https://i.postimg.cc/BncyKD9D/Design-sans-titre-1.png');
    background-size: cover;
    background-position: center;
    background-attachment: fixed;
    background-repeat: no-repeat;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
}

main {
    flex: 1;
}

header {
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(10px);
    box-shadow: var(--shadow);
    position: sticky;
    top: 0;
    z-index: 1000;
    border-bottom: 1px solid rgba(0,0,0,0.05);
}

.container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 0 20px;
}

.header-top {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 15px 0;
}

.logo {
    display: flex;
    align-items: center;
    gap: 12px;
    text-decoration: none;
}

.logo-img {
    height: 55px;
    width: auto;
    object-fit: contain;
    transition: var(--transition);
}

.logo:hover .logo-img {
    transform: scale(1.05);
}

.logo-text {
    font-size: 28px;
    font-weight: 800;
    color: var(--primary);
    letter-spacing: -0.5px;
}

.logo-text span {
    color: var(--accent);
    position: relative;
}

.logo-text span::after {
    content: '';
    position: absolute;
    bottom: -2px;
    left: 0;
    width: 100%;
    height: 2px;
    background: var(--accent);
    transform: scaleX(0);
    transition: var(--transition);
}

.logo:hover .logo-text span::after {
    transform: scaleX(1);
}

nav ul {
    display: flex;
    list-style: none;
    gap: 32px;
}

nav a {
    text-decoration: none;
    color: var(--dark);
    font-weight: 600;
    font-size: 16px;
    padding: 8px 0;
    position: relative;
    transition: var(--transition);
    cursor: pointer;
}

nav a::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: 0;
    width: 0;
    height: 2px;
    background: var(--accent);
    transition: var(--transition);
}

nav a:hover {
    color: var(--primary);
}

nav a:hover::after {
    width: 100%;
}

.header-actions {
    display: flex;
    align-items: center;
    gap: 20px;
}

.client-space {
    position: relative;
}

.client-space-btn {
    background: var(--light);
    border: 2px solid var(--light-gray);
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 8px;
    font-weight: 600;
    padding: 10px 16px;
    border-radius: var(--radius-sm);
    transition: var(--transition);
    font-size: 14px;
}

.client-space-btn:hover {
    background: var(--primary);
    color: white;
    border-color: var(--primary);
    transform: translateY(-2px);
    box-shadow: var(--shadow);
}

.dropdown-menu {
    position: absolute;
    top: 100%;
    right: 0;
    background: white;
    box-shadow: var(--shadow-hover);
    border-radius: var(--radius);
    padding: 8px 0;
    min-width: 220px;
    display: none;
    z-index: 1001;
    margin-top: 8px;
    border: 1px solid var(--light-gray);
}

.dropdown-menu.show {
    display: block;
    animation: fadeIn 0.3s ease;
}

.dropdown-menu a {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 14px 20px;
    text-decoration: none;
    color: var(--dark);
    transition: var(--transition);
    border: none;
    background: none;
    width: 100%;
    text-align: left;
    font-size: 14px;
    cursor: pointer;
    border-radius: 0;
}

.dropdown-menu a:hover {
    background: var(--light);
    color: var(--primary);
    transform: translateX(4px);
}

.cart-btn {
    background: var(--accent);
    border: none;
    cursor: pointer;
    position: relative;
    font-size: 18px;
    padding: 12px;
    border-radius: var(--radius-sm);
    transition: var(--transition);
    color: white;
}

.cart-btn:hover {
    background: var(--accent-light);
    transform: translateY(-2px);
    box-shadow: var(--shadow);
}

.cart-count {
    position: absolute;
    top: -8px;
    right: -8px;
    background: var(--primary);
    color: white;
    border-radius: 50%;
    width: 22px;
    height: 22px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 12px;
    font-weight: 700;
    border: 2px solid white;
}

.hero {
    background: linear-gradient(rgba(45, 80, 22, 0.9), rgba(74, 124, 42, 0.8)), 
                url('https://i.postimg.cc/BncyKD9D/Design-sans-titre-1.png');
    background-size: cover;
    background-position: center;
    color: white;
    padding: 100px 0;
    text-align: center;
    position: relative;
    overflow: hidden;
}

.hero::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" preserveAspectRatio="none"><defs><pattern id="grid" width="10" height="10" patternUnits="userSpaceOnUse"><path d="M 10 0 L 0 0 0 10" fill="none" stroke="rgba(255,255,255,0.1)" stroke-width="0.5"/></pattern></defs><rect width="100" height="100" fill="url(%23grid)"/></svg>');
}

.hero .container {
    position: relative;
    z-index: 1;
}

.hero h1 {
    font-size: 3.5rem;
    margin-bottom: 24px;
    font-weight: 800;
    letter-spacing: -1px;
    text-shadow: 0 2px 10px rgba(0,0,0,0.2);
}

.hero p {
    font-size: 1.3rem;
    margin-bottom: 40px;
    opacity: 0.95;
    font-weight: 400;
    max-width: 600px;
    margin-left: auto;
    margin-right: auto;
}

.btn {
    display: inline-flex;
    align-items: center;
    gap: 10px;
    padding: 16px 32px;
    background: white;
    color: var(--primary);
    text-decoration: none;
    border-radius: var(--radius);
    font-weight: 700;
    transition: var(--transition);
    border: 2px solid transparent;
    font-size: 16px;
    box-shadow: var(--shadow);
}

.btn:hover {
    background: var(--light);
    transform: translateY(-3px);
    box-shadow: var(--shadow-hover);
    border-color: rgba(255,255,255,0.3);
}

.featured-products {
    padding: 100px 0;
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(10px);
}

.section-title {
    text-align: center;
    margin-bottom: 60px;
    font-size: 2.5rem;
    color: var(--primary);
    font-weight: 800;
    position: relative;
}

.section-title::after {
    content: '';
    position: absolute;
    bottom: -15px;
    left: 50%;
    transform: translateX(-50%);
    width: 80px;
    height: 4px;
    background: var(--accent);
    border-radius: 2px;
}

.products-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 30px;
}

.product-card {
    background: white;
    border-radius: var(--radius);
    overflow: hidden;
    box-shadow: var(--shadow);
    transition: var(--transition);
    border: 1px solid var(--light-gray);
    position: relative;
    backdrop-filter: blur(10px);
}

.product-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 4px;
    background: var(--gradient);
}

.product-card:hover {
    transform: translateY(-8px);
    box-shadow: var(--shadow-hover);
}

.product-image {
    height: 220px;
    background: transparent;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 30px;
    position: relative;
    overflow: hidden;
}

.product-image::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
    transition: var(--transition);
}

.product-card:hover .product-image::before {
    left: 100%;
}

.product-image img {
    max-width: 100%;
    max-height: 100%;
    object-fit: contain;
    transition: var(--transition);
    background: transparent;
}

.product-card:hover .product-image img {
    transform: scale(1.05);
}

.product-info {
    padding: 24px;
}

.product-info h3 {
    margin-bottom: 12px;
    color: var(--primary);
    font-size: 1.2rem;
    font-weight: 700;
    min-height: auto;
}

.product-price {
    font-size: 1.5rem;
    font-weight: 800;
    color: var(--secondary);
    margin-bottom: 20px;
}

.featured-btn {
    display: inline-flex;
    align-items: center;
    gap: 8px;
    padding: 10px 20px;
    border: 2px solid var(--primary);
    color: var(--primary);
    text-decoration: none;
    border-radius: var(--radius-sm);
    font-weight: 600;
    transition: var(--transition);
    margin-right: 10px;
    cursor: pointer;
    font-size: 14px;
}

.featured-btn.primary {
    background: var(--primary);
    color: white;
}

.featured-btn:hover {
    background: var(--primary);
    color: white;
    transform: translateY(-2px);
    box-shadow: var(--shadow);
}

.featured-btn:disabled {
    background: #ccc;
    border-color: #ccc;
    color: #666;
    cursor: not-allowed;
    transform: none;
    box-shadow: none;
}

.modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0,0,0,0.6);
    z-index: 2000;
    align-items: center;
    justify-content: center;
    backdrop-filter: blur(5px);
}

.modal-content {
    background: white;
    padding: 40px;
    border-radius: var(--radius);
    max-width: 500px;
    width: 90%;
    max-height: 90vh;
    overflow-y: auto;
    box-shadow: var(--shadow-hover);
    border: 1px solid var(--light-gray);
    animation: slideUp 0.4s ease;
}

.modal-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 30px;
    padding-bottom: 20px;
    border-bottom: 2px solid var(--light-gray);
}

.modal-header h2 {
    color: var(--primary);
    font-weight: 700;
    font-size: 1.8rem;
}

.close-modal {
    background: var(--light);
    border: none;
    font-size: 24px;
    cursor: pointer;
    padding: 8px;
    border-radius: 50%;
    transition: var(--transition);
    color: var(--dark-gray);
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
}

.close-modal:hover {
    background: var(--error);
    color: white;
    transform: rotate(90deg);
}

.form-group {
    margin-bottom: 24px;
}

.form-group label {
    display: block;
    margin-bottom: 8px;
    font-weight: 600;
    color: var(--dark);
}

.form-group input, .form-group textarea, .form-group select {
    width: 100%;
    padding: 14px;
    border: 2px solid var(--light-gray);
    border-radius: var(--radius-sm);
    font-size: 16px;
    transition: var(--transition);
    background: var(--light);
}

.form-group input:focus, .form-group textarea:focus, .form-group select:focus {
    outline: none;
    border-color: var(--accent);
    background: white;
    box-shadow: 0 0 0 3px rgba(124, 179, 66, 0.1);
}

.form-submit {
    width: 100%;
    padding: 16px;
    background: var(--gradient);
    color: white;
    border: none;
    border-radius: var(--radius-sm);
    font-size: 16px;
    font-weight: 700;
    cursor: pointer;
    transition: var(--transition);
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.form-submit:hover {
    transform: translateY(-2px);
    box-shadow: var(--shadow);
}

.cart-modal-content {
    max-width: 800px;
}

.cart-items {
    margin-bottom: 30px;
}

.cart-item {
    display: flex;
    align-items: center;
    padding: 20px 0;
    border-bottom: 1px solid var(--light-gray);
    transition: var(--transition);
}

.cart-item:hover {
    background: var(--light);
    margin: 0 -20px;
    padding: 20px;
    border-radius: var(--radius-sm);
}

.cart-item-image {
    width: 80px;
    height: 80px;
    background: var(--light);
    margin-right: 20px;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 10px;
    border-radius: var(--radius-sm);
    border: 1px solid var(--light-gray);
}

.cart-item-image img {
    max-width: 100%;
    max-height: 100%;
    object-fit: contain;
    background: transparent;
}

.cart-item-info {
    flex: 1;
}

.cart-item-info h4 {
    color: var(--primary);
    margin-bottom: 5px;
    font-weight: 600;
}

.cart-item-price {
    font-weight: 700;
    color: var(--secondary);
    font-size: 1.1rem;
}

.cart-item-quantity {
    display: flex;
    align-items: center;
    gap: 12px;
    margin: 12px 0;
}

.quantity-btn {
    background: var(--light);
    border: 2px solid var(--light-gray);
    width: 32px;
    height: 32px;
    border-radius: 50%;
    cursor: pointer;
    transition: var(--transition);
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 600;
}

.quantity-btn:hover {
    background: var(--accent);
    color: white;
    border-color: var(--accent);
}

.cart-total {
    text-align: right;
    font-size: 1.5rem;
    font-weight: 800;
    margin-bottom: 30px;
    color: var(--primary);
    padding: 20px 0;
    border-top: 2px solid var(--light-gray);
}

.custom-alert {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0,0,0,0.7);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 3000;
    backdrop-filter: blur(5px);
}

.custom-alert-content {
    background: white;
    padding: 40px;
    border-radius: var(--radius);
    max-width: 600px;
    width: 90%;
    max-height: 80vh;
    overflow-y: auto;
    box-shadow: var(--shadow-hover);
    animation: slideUp 0.4s ease;
}

.product-details {
    text-align: center;
}

.product-details-image {
    max-width: 220px;
    max-height: 220px;
    margin: 0 auto 30px;
    display: block;
    border-radius: var(--radius);
    box-shadow: var(--shadow);
    background: transparent;
}

.product-details h3 {
    color: var(--primary);
    margin-bottom: 20px;
    font-size: 1.8rem;
    font-weight: 700;
}

.product-details-price {
    font-size: 2rem;
    font-weight: 800;
    color: var(--secondary);
    margin-bottom: 30px;
}

.product-description {
    text-align: left;
    margin: 25px 0;
    line-height: 1.8;
    color: var(--dark-gray);
}

.product-features {
    text-align: left;
    margin: 25px 0;
}

.product-features ul {
    list-style: none;
    padding-left: 0;
}

.product-features li {
    padding: 8px 0;
    position: relative;
    padding-left: 30px;
    color: var(--dark);
}

.product-features li:before {
    content: "â";
    color: var(--success);
    font-weight: bold;
    position: absolute;
    left: 0;
    font-size: 1.1rem;
}

.usage-tips {
    background: var(--light);
    padding: 20px;
    border-radius: var(--radius);
    margin: 25px 0;
    text-align: left;
    border-left: 4px solid var(--accent);
}

.usage-tips h4 {
    color: var(--primary);
    margin-bottom: 12px;
    font-weight: 700;
}

/* SECTION Ã PROPOS AMÃLIORÃE */
.about-section {
    padding: 100px 0;
    background: linear-gradient(135deg, rgba(248, 249, 250, 0.95), rgba(233, 236, 239, 0.95));
    backdrop-filter: blur(10px);
    display: none;
}

.about-section.active {
    display: block;
    animation: fadeIn 0.5s ease;
}

.about-hero {
    text-align: center;
    margin-bottom: 80px;
}

.about-hero h1 {
    font-size: 3.5rem;
    color: var(--primary);
    margin-bottom: 20px;
    font-weight: 800;
}

.about-hero p {
    font-size: 1.3rem;
    color: var(--dark-gray);
    max-width: 800px;
    margin: 0 auto;
    line-height: 1.8;
}

.about-content {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 80px;
    align-items: center;
    margin-bottom: 80px;
}

.about-text h2 {
    color: var(--primary);
    font-size: 2.5rem;
    margin-bottom: 30px;
    font-weight: 800;
    position: relative;
}

.about-text h2::after {
    content: '';
    position: absolute;
    bottom: -10px;
    left: 0;
    width: 80px;
    height: 4px;
    background: var(--accent);
    border-radius: 2px;
}

.about-text p {
    color: var(--dark);
    margin-bottom: 25px;
    font-size: 1.1rem;
    line-height: 1.8;
}

.about-image {
    position: relative;
}

.about-image img {
    width: 100%;
    border-radius: var(--radius);
    box-shadow: var(--shadow-hover);
    transition: var(--transition);
}

.about-image:hover img {
    transform: scale(1.02);
}

.about-features {
    margin: 60px 0;
}

.about-features h3 {
    text-align: center;
    font-size: 2.2rem;
    color: var(--primary);
    margin-bottom: 50px;
    font-weight: 700;
}

.feature-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 30px;
}

.feature-item {
    background: white;
    padding: 35px 25px;
    border-radius: var(--radius);
    box-shadow: var(--shadow);
    border-top: 4px solid var(--accent);
    transition: var(--transition);
    text-align: center;
    position: relative;
    overflow: hidden;
}

.feature-item::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(124, 179, 66, 0.1), transparent);
    transition: var(--transition);
}

.feature-item:hover::before {
    left: 100%;
}

.feature-item:hover {
    transform: translateY(-10px);
    box-shadow: var(--shadow-hover);
}

.feature-icon {
    width: 70px;
    height: 70px;
    background: var(--gradient);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    margin: 0 auto 20px;
    color: white;
    font-size: 1.8rem;
    transition: var(--transition);
}

.feature-item:hover .feature-icon {
    transform: scale(1.1) rotate(5deg);
}

.feature-item h4 {
    color: var(--primary);
    margin-bottom: 15px;
    font-weight: 700;
    font-size: 1.3rem;
}

.feature-item p {
    color: var(--dark-gray);
    font-size: 1rem;
    line-height: 1.6;
}

.about-values {
    background: var(--primary);
    color: white;
    padding: 80px 0;
    margin: 80px 0;
    border-radius: var(--radius);
    position: relative;
    overflow: hidden;
}

.about-values::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" preserveAspectRatio="none"><defs><pattern id="dots" width="20" height="20" patternUnits="userSpaceOnUse"><circle cx="10" cy="10" r="1" fill="rgba(255,255,255,0.1)"/></pattern></defs><rect width="100" height="100" fill="url(%23dots)"/></svg>');
}

.about-values .container {
    position: relative;
    z-index: 1;
}

.about-values h2 {
    text-align: center;
    font-size: 2.5rem;
    margin-bottom: 60px;
    font-weight: 700;
}

.values-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 40px;
}

.value-item {
    text-align: center;
    padding: 30px;
    background: rgba(255, 255, 255, 0.1);
    border-radius: var(--radius);
    backdrop-filter: blur(10px);
    border: 1px solid rgba(255, 255, 255, 0.2);
    transition: var(--transition);
}

.value-item:hover {
    transform: translateY(-5px);
    background: rgba(255, 255, 255, 0.15);
}

.value-icon {
    font-size: 3rem;
    margin-bottom: 20px;
    color: var(--accent-light);
}

.value-item h3 {
    font-size: 1.5rem;
    margin-bottom: 15px;
    font-weight: 600;
}

.value-item p {
    font-size: 1rem;
    line-height: 1.6;
    opacity: 0.9;
}

.about-stats {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 30px;
    margin: 80px 0;
    text-align: center;
}

.stat-item {
    background: white;
    padding: 40px 20px;
    border-radius: var(--radius);
    box-shadow: var(--shadow);
    transition: var(--transition);
    position: relative;
    overflow: hidden;
}

.stat-item::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 4px;
    background: var(--gradient);
}

.stat-item:hover {
    transform: translateY(-8px);
    box-shadow: var(--shadow-hover);
}

.stat-number {
    font-size: 3rem;
    font-weight: 800;
    color: var(--primary);
    margin-bottom: 10px;
    display: block;
}

.stat-label {
    color: var(--dark-gray);
    font-weight: 600;
    font-size: 1.1rem;
}

.about-team {
    margin: 80px 0;
}

.about-team h2 {
    text-align: center;
    font-size: 2.5rem;
    color: var(--primary);
    margin-bottom: 60px;
    font-weight: 700;
}

.team-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 30px;
}

.team-member {
    background: white;
    border-radius: var(--radius);
    overflow: hidden;
    box-shadow: var(--shadow);
    transition: var(--transition);
    text-align: center;
}

.team-member:hover {
    transform: translateY(-8px);
    box-shadow: var(--shadow-hover);
}

.team-member-img {
    width: 100%;
    height: 250px;
    background: var(--light);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 4rem;
    color: var(--primary);
}

.team-member-info {
    padding: 25px;
}

.team-member h4 {
    color: var(--primary);
    margin-bottom: 8px;
    font-weight: 700;
    font-size: 1.2rem;
}

.team-member-role {
    color: var(--accent);
    font-weight: 600;
    margin-bottom: 15px;
    font-size: 0.95rem;
}

.team-member p {
    color: var(--dark-gray);
    font-size: 0.9rem;
    line-height: 1.6;
}

.about-commitment {
    background: var(--light);
    padding: 80px 0;
    border-radius: var(--radius);
    margin: 80px 0;
    text-align: center;
}

.about-commitment h2 {
    font-size: 2.5rem;
    color: var(--primary);
    margin-bottom: 30px;
    font-weight: 700;
}

.about-commitment p {
    font-size: 1.2rem;
    color: var(--dark);
    max-width: 800px;
    margin: 0 auto 40px;
    line-height: 1.8;
}

.commitment-features {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 30px;
    margin-top: 50px;
}

.commitment-item {
    background: white;
    padding: 30px;
    border-radius: var(--radius);
    box-shadow: var(--shadow);
    transition: var(--transition);
}

.commitment-item:hover {
    transform: translateY(-5px);
    box-shadow: var(--shadow-hover);
}

.commitment-item h4 {
    color: var(--primary);
    margin-bottom: 15px;
    font-weight: 700;
}

.commitment-item p {
    color: var(--dark-gray);
    font-size: 1rem;
    margin: 0;
}

/* Styles pour la navigation active */
.nav-active {
    color: var(--primary) !important;
    font-weight: 700 !important;
}

.nav-active::after {
    width: 100% !important;
    background: var(--accent) !important;
}

/* Styles pour le footer */
footer {
    background: var(--primary);
    color: white;
    text-align: center;
    padding: 30px 20px;
    margin-top: auto;
    border-top: 4px solid var(--accent);
}

footer p {
    margin: 0;
    font-size: 1rem;
    opacity: 0.9;
}

/* Animations */
@keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
}

@keyframes slideUp {
    from { 
        opacity: 0;
        transform: translateY(30px);
    }
    to { 
        opacity: 1;
        transform: translateY(0);
    }
}

@keyframes slideInRight {
    from {
        opacity: 0;
        transform: translateX(100%);
    }
    to {
        opacity: 1;
        transform: translateX(0);
    }
}

/* Responsive */
@media (max-width: 768px) {
    .header-top {
        flex-direction: column;
        gap: 20px;
        padding: 20px 0;
    }
    
    .logo {
        justify-content: center;
    }
    
    nav ul {
        gap: 15px;
        flex-wrap: wrap;
        justify-content: center;
    }
    
    .hero {
        padding: 80px 0;
    }
    
    .hero h1 {
        font-size: 2.5rem;
    }
    
    .hero p {
        font-size: 1.1rem;
    }
    
    .products-grid {
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        gap: 20px;
    }
    
    .section-title {
        font-size: 2rem;
    }
    
    .modal-content {
        padding: 30px 20px;
    }
    
    .about-content {
        grid-template-columns: 1fr;
        gap: 40px;
    }
    
    .about-hero h1 {
        font-size: 2.5rem;
    }
    
    .about-hero p {
        font-size: 1.1rem;
    }
    
    .feature-grid {
        grid-template-columns: 1fr;
    }
    
    .values-grid {
        grid-template-columns: 1fr;
    }
    
    .about-stats {
        grid-template-columns: repeat(2, 1fr);
    }
    
    .team-grid {
        grid-template-columns: repeat(2, 1fr);
    }
    
    footer {
        padding: 25px 15px;
    }
    
    footer p {
        font-size: 0.9rem;
    }
}

@media (max-width: 480px) {
    .container {
        padding: 0 15px;
    }
    
    .hero h1 {
        font-size: 2rem;
    }
    
    .products-grid {
        grid-template-columns: 1fr;
    }
    
    .featured-btn {
        width: 100%;
        justify-content: center;
        margin-bottom: 10px;
    }
    
    .about-stats {
        grid-template-columns: 1fr;
    }
    
    .team-grid {
        grid-template-columns: 1fr;
    }
    
    footer {
        padding: 20px 10px;
    }
    
    footer p {
        font-size: 0.85rem;
    }
}

/* Styles pour l'interface d'administration */
.admin-panel {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: white;
    z-index: 3000;
    overflow-y: auto;
}

.admin-header {
    background: var(--gradient);
    color: white;
    padding: 20px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    box-shadow: var(--shadow);
}

.admin-header h2 {
    font-size: 1.8rem;
    font-weight: 700;
}

.admin-close {
    background: rgba(255,255,255,0.2);
    border: none;
    color: white;
    font-size: 1.5rem;
    cursor: pointer;
    padding: 10px;
    border-radius: 50%;
    width: 50px;
    height: 50px;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: var(--transition);
}

.admin-close:hover {
    background: rgba(255,255,255,0.3);
    transform: rotate(90deg);
}

.admin-content {
    padding: 30px;
    max-width: 1200px;
    margin: 0 auto;
}

.admin-section {
    background: white;
    border-radius: var(--radius);
    padding: 30px;
    margin-bottom: 30px;
    box-shadow: var(--shadow);
    border: 1px solid var(--light-gray);
}

.admin-section h3 {
    color: var(--primary);
    margin-bottom: 20px;
    font-size: 1.5rem;
    font-weight: 700;
    border-bottom: 2px solid var(--light-gray);
    padding-bottom: 10px;
}

.admin-table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 20px;
}

.admin-table th,
.admin-table td {
    padding: 15px;
    text-align: left;
    border-bottom: 1px solid var(--light-gray);
}

.admin-table th {
    background: var(--light);
    font-weight: 600;
    color: var(--primary);
}

.admin-table tr:hover {
    background: var(--light);
}

.admin-form {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 20px;
}

.admin-form .form-group {
    margin-bottom: 20px;
}

.admin-form .form-group.full-width {
    grid-column: 1 / -1;
}

.admin-actions {
    display: flex;
    gap: 15px;
    margin-top: 30px;
}

.admin-btn {
    padding: 12px 24px;
    border: none;
    border-radius: var(--radius-sm);
    font-weight: 600;
    cursor: pointer;
    transition: var(--transition);
    display: flex;
    align-items: center;
    gap: 8px;
}

.admin-btn.primary {
    background: var(--primary);
    color: white;
}

.admin-btn.secondary {
    background: var(--light-gray);
    color: var(--dark);
}

.admin-btn.danger {
    background: var(--error);
    color: white;
}

.admin-btn.success {
    background: var(--success);
    color: white;
}

.admin-btn.warning {
    background: var(--warning);
    color: white;
}

.admin-btn.info {
    background: #17a2b8;
    color: white;
}

.admin-btn:hover {
    transform: translateY(-2px);
    box-shadow: var(--shadow);
}

.stats-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 20px;
    margin-bottom: 30px;
}

.stat-card {
    background: white;
    border-radius: var(--radius);
    padding: 25px;
    text-align: center;
    box-shadow: var(--shadow);
    border-left: 4px solid var(--accent);
    transition: var(--transition);
}

.stat-card:hover {
    transform: translateY(-5px);
    box-shadow: var(--shadow-hover);
}

.stat-value {
    font-size: 2.5rem;
    font-weight: 800;
    color: var(--primary);
    margin-bottom: 10px;
}

.stat-label {
    color: var(--dark-gray);
    font-weight: 600;
}

/* Styles amÃ©liorÃ©s pour l'Ã©diteur de contenu */
.content-editor {
    max-width: 1200px;
    width: 95%;
    max-height: 90vh;
    overflow-y: auto;
}

.editor-tabs {
    display: flex;
    gap: 5px;
    margin-bottom: 20px;
    border-bottom: 2px solid var(--light-gray);
    flex-wrap: wrap;
}

.editor-tab {
    padding: 12px 20px;
    background: var(--light);
    border: none;
    border-radius: var(--radius-sm) var(--radius-sm) 0 0;
    cursor: pointer;
    font-weight: 600;
    transition: var(--transition);
    color: var(--dark-gray);
    font-size: 14px;
}

.editor-tab.active {
    background: var(--primary);
    color: white;
}

.editor-panel {
    display: none;
    padding: 20px 0;
}

.editor-panel.active {
    display: block;
    animation: fadeIn 0.3s ease;
}

.editor-section {
    background: white;
    border: 1px solid var(--light-gray);
    border-radius: var(--radius-sm);
    padding: 25px;
    margin-bottom: 20px;
    box-shadow: var(--shadow);
}

.editor-section-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;
    padding-bottom: 15px;
    border-bottom: 2px solid var(--light-gray);
}

.editor-section-header h4 {
    color: var(--primary);
    margin: 0;
    font-size: 1.2rem;
}

.section-controls {
    display: flex;
    gap: 10px;
}

.wysiwyg-toolbar {
    display: flex;
    gap: 5px;
    margin-bottom: 15px;
    padding: 15px;
    background: var(--light);
    border-radius: var(--radius-sm);
    border: 1px solid var(--light-gray);
    flex-wrap: wrap;
}

.wysiwyg-btn {
    padding: 10px 15px;
    background: white;
    border: 1px solid var(--light-gray);
    border-radius: var(--radius-sm);
    cursor: pointer;
    transition: var(--transition);
    font-size: 14px;
    display: flex;
    align-items: center;
    gap: 5px;
}

.wysiwyg-btn:hover {
    background: var(--accent);
    color: white;
    border-color: var(--accent);
}

.wysiwyg-btn.active {
    background: var(--primary);
    color: white;
    border-color: var(--primary);
}

.wysiwyg-group {
    display: flex;
    gap: 2px;
    padding-right: 15px;
    border-right: 1px solid var(--light-gray);
    margin-right: 15px;
}

.wysiwyg-group:last-child {
    border-right: none;
    margin-right: 0;
}

.editor-field {
    margin-bottom: 25px;
}

.editor-field label {
    display: block;
    margin-bottom: 8px;
    font-weight: 600;
    color: var(--dark);
    font-size: 14px;
}

.editor-field input, .editor-field textarea, .editor-field select {
    width: 100%;
    padding: 12px;
    border: 2px solid var(--light-gray);
    border-radius: var(--radius-sm);
    font-size: 16px;
    transition: var(--transition);
    background: white;
    font-family: 'Inter', sans-serif;
}

.editor-field input:focus, .editor-field textarea:focus, .editor-field select:focus {
    outline: none;
    border-color: var(--accent);
    box-shadow: 0 0 0 3px rgba(124, 179, 66, 0.1);
}

.editor-field textarea {
    min-height: 120px;
    resize: vertical;
}

.editor-field.full-width {
    grid-column: 1 / -1;
}

.image-upload {
    border: 2px dashed var(--light-gray);
    border-radius: var(--radius-sm);
    padding: 30px;
    text-align: center;
    transition: var(--transition);
    cursor: pointer;
}

.image-upload:hover {
    border-color: var(--accent);
    background: rgba(124, 179, 66, 0.05);
}

.image-upload.dragover {
    border-color: var(--accent);
    background: rgba(124, 179, 66, 0.1);
}

.upload-placeholder {
    color: var(--dark-gray);
    font-size: 14px;
}

.upload-placeholder i {
    font-size: 2rem;
    margin-bottom: 10px;
    color: var(--accent);
}

.image-preview {
    max-width: 200px;
    max-height: 150px;
    margin: 10px auto;
    display: none;
}

.image-preview img {
    max-width: 100%;
    max-height: 100%;
    border-radius: var(--radius-sm);
}

.grid-editor {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 20px;
    margin: 20px 0;
}

.feature-editor {
    background: var(--light);
    padding: 20px;
    border-radius: var(--radius-sm);
    border-left: 4px solid var(--accent);
}

.feature-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 15px;
}

.feature-title {
    font-weight: 600;
    color: var(--primary);
}

.feature-controls {
    display: flex;
    gap: 5px;
}

.content-preview {
    background: white;
    padding: 30px;
    border-radius: var(--radius-sm);
    border: 1px solid var(--light-gray);
    margin-top: 20px;
    max-height: 500px;
    overflow-y: auto;
}

.preview-header {
    text-align: center;
    margin-bottom: 40px;
    padding-bottom: 30px;
    border-bottom: 2px solid var(--light-gray);
}

.preview-title {
    color: var(--primary);
    font-size: 2.5rem;
    margin-bottom: 15px;
    font-weight: 800;
}

.preview-subtitle {
    color: var(--dark-gray);
    font-size: 1.3rem;
    line-height: 1.6;
}

.preview-content {
    line-height: 1.7;
    color: var(--dark);
}

.preview-section {
    margin-bottom: 40px;
}

.preview-features {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 25px;
    margin: 30px 0;
}

.preview-feature {
    background: white;
    padding: 25px;
    border-radius: var(--radius);
    box-shadow: var(--shadow);
    text-align: center;
    border-top: 4px solid var(--accent);
}

.preview-feature-icon {
    width: 60px;
    height: 60px;
    background: var(--gradient);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    margin: 0 auto 15px;
    color: white;
    font-size: 1.5rem;
}

.preview-feature h4 {
    color: var(--primary);
    margin-bottom: 10px;
    font-weight: 700;
}

.preview-feature p {
    color: var(--dark-gray);
    font-size: 0.95rem;
    line-height: 1.6;
}

.editor-actions {
    display: flex;
    gap: 15px;
    margin-top: 30px;
    justify-content: space-between;
    align-items: center;
    padding-top: 20px;
    border-top: 2px solid var(--light-gray);
}

.action-group {
    display: flex;
    gap: 10px;
}

.save-status {
    font-size: 14px;
    color: var(--dark-gray);
    display: flex;
    align-items: center;
    gap: 5px;
}

.save-status.saving {
    color: var(--warning);
}

.save-status.saved {
    color: var(--success);
}

/* Styles pour l'Ã©diteur de texte enrichi */
.wysiwyg-editor {
    min-height: 400px;
    border: 1px solid var(--light-gray);
    border-radius: var(--radius-sm);
    padding: 20px;
    font-family: 'Inter', sans-serif;
    line-height: 1.6;
    background: white;
    outline: none;
    overflow-y: auto;
}

.wysiwyg-editor:focus {
    border-color: var(--accent);
    box-shadow: 0 0 0 3px rgba(124, 179, 66, 0.1);
}

.wysiwyg-editor h1, .wysiwyg-editor h2, .wysiwyg-editor h3 {
    color: var(--primary);
    margin: 25px 0 15px 0;
}

.wysiwyg-editor h1 {
    font-size: 2rem;
    font-weight: 800;
}

.wysiwyg-editor h2 {
    font-size: 1.5rem;
    font-weight: 700;
}

.wysiwyg-editor h3 {
    font-size: 1.25rem;
    font-weight: 600;
}

.wysiwyg-editor p {
    margin-bottom: 15px;
}

.wysiwyg-editor ul, .wysiwyg-editor ol {
    margin: 15px 0;
    padding-left: 30px;
}

.wysiwyg-editor li {
    margin-bottom: 8px;
}

.wysiwyg-editor blockquote {
    border-left: 4px solid var(--accent);
    padding-left: 20px;
    margin: 20px 0;
    font-style: italic;
    color: var(--dark-gray);
    background: var(--light);
    padding: 15px 20px;
    border-radius: 0 var(--radius-sm) var(--radius-sm) 0;
}

.wysiwyg-editor img {
    max-width: 100%;
    height: auto;
    border-radius: var(--radius-sm);
    margin: 15px 0;
}

.wysiwyg-editor a {
    color: var(--accent);
    text-decoration: none;
    font-weight: 600;
}

.wysiwyg-editor a:hover {
    text-decoration: underline;
}

.wysiwyg-editor table {
    width: 100%;
    border-collapse: collapse;
    margin: 20px 0;
}

.wysiwyg-editor table th,
.wysiwyg-editor table td {
    padding: 12px;
    border: 1px solid var(--light-gray);
    text-align: left;
}

.wysiwyg-editor table th {
    background: var(--light);
    font-weight: 600;
    color: var(--primary);
}

/* Responsive */
@media (max-width: 768px) {
    .content-editor {
        width: 98%;
        padding: 15px;
    }
    
    .editor-tabs {
        flex-direction: column;
    }
    
    .editor-tab {
        border-radius: var(--radius-sm);
        margin-bottom: 5px;
    }
    
    .wysiwyg-toolbar {
        flex-direction: column;
        align-items: flex-start;
    }
    
    .wysiwyg-group {
        border-right: none;
        margin-right: 0;
        padding-right: 0;
        margin-bottom: 10px;
        width: 100%;
        justify-content: space-between;
    }
    
    .editor-actions {
        flex-direction: column;
        gap: 15px;
    }
    
    .action-group {
        width: 100%;
        justify-content: space-between;
    }
    
    .preview-title {
        font-size: 2rem;
    }
    
    .preview-features {
        grid-template-columns: 1fr;
    }
    
    .grid-editor {
        grid-template-columns: 1fr;
    }
}
</style>
</head>
<body>
<header>
    <div class="container">
        <div class="header-top">
            <a href="#home" class="logo">
                <img src="https://i.goopics.net/ugbggy.png" alt="LD Organics" class="logo-img">
                <div class="logo-text">LD<span>Organics</span></div>
            </a>
            <nav>
                <ul>
                    <li><a href="#home" class="nav-active" onclick="showSection('home')">Accueil</a></li>
                    <li><a href="#products" onclick="showSection('products')">Produits</a></li>
                    <li><a href="#about" onclick="showSection('about')">Ã propos</a></li>
                    <li><a href="#contact" onclick="showSection('contact')">Contact</a></li>
                </ul>
            </nav>
            <div class="header-actions">
                <div class="client-space">
                    <button class="client-space-btn" id="clientSpaceLink">
                        <i class="fas fa-user"></i> Espace Client <i class="fas fa-chevron-down" style="margin-left:5px;font-size:12px;"></i>
                    </button>
                    <div class="dropdown-menu" id="dropdownMenu">
                        <a href="#" id="createAccountOption"><i class="fas fa-user-plus"></i> CrÃ©er un compte</a>
                        <a href="#" id="loginOption"><i class="fas fa-sign-in-alt"></i> Se connecter</a>
                        <a href="#" id="myAccountOption" style="display:none;"><i class="fas fa-user-circle"></i> Mon compte</a>
                        <a href="#" id="adminLink" style="display:none;"><i class="fas fa-user-shield"></i> Administration</a>
                        <a href="#" id="operatorLink" style="display:none;"><i class="fas fa-tasks"></i> OpÃ©rateur commandes</a>
                        <a href="#" id="logoutOption" style="display:none;"><i class="fas fa-sign-out-alt"></i> DÃ©connexion</a>
                    </div>
                </div>
                <button class="cart-btn" onclick="openCartModal()">
                    <i class="fas fa-shopping-cart"></i>
                    <span class="cart-count">0</span>
                </button>
            </div>
        </div>
    </div>
</header>

<main>
<!-- Section Accueil (visible par dÃ©faut) -->
<section id="home" class="hero">
    <div class="container">
        <h1>Produits CBD de QualitÃ© SupÃ©rieure</h1>
        <p>DÃ©couvrez notre sÃ©lection exclusive de produits au CBD pour votre bien-Ãªtre quotidien. Naturel, biologique et testÃ© en laboratoire.</p>
        <a href="#products" class="btn" onclick="showSection('products')">
            <i class="fas fa-leaf"></i> DÃ©couvrir nos produits
        </a>
    </div>
</section>

<!-- Section Produits (cachÃ©e par dÃ©faut) -->
<section id="products" class="featured-products" style="display: none;">
    <div class="container">
        <h2 class="section-title">Nos Produits Premium</h2>
        <div class="products-grid" id="featuredProductsGrid">
            <!-- Produits affichÃ©s dynamiquement -->
        </div>
    </div>
</section>

<!-- Section Ã propos AMÃLIORÃE (cachÃ©e par dÃ©faut) -->
<section id="about" class="about-section" style="display: none;">
    <div class="container">
        <div id="aboutContent">
            <!-- Contenu chargÃ© dynamiquement depuis le localStorage -->
        </div>
    </div>
</section>

<!-- Section Contact (cachÃ©e par dÃ©faut) -->
<section id="contact" class="featured-products" style="display: none;">
    <div class="container">
        <div id="contactContent">
            <!-- Contenu chargÃ© dynamiquement depuis le localStorage -->
        </div>
    </div>
</section>

</main>

<!-- Footer ajoutÃ© ici -->
<footer>
    <p>&copy; 2025 LD Organics. Tous droits rÃ©servÃ©s.</p>
</footer>

<!-- Modales -->
<div id="loginModal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h2><i class="fas fa-sign-in-alt"></i> Connexion</h2>
            <button class="close-modal" onclick="closeModal('loginModal')">&times;</button>
        </div>
        <form id="loginForm">
            <div class="form-group">
                <label for="loginEmail">Email</label>
                <input type="email" id="loginEmail" required>
            </div>
            <div class="form-group">
                <label for="loginPassword">Mot de passe</label>
                <input type="password" id="loginPassword" required>
            </div>
            <button type="submit" class="form-submit">Se connecter</button>
        </form>
    </div>
</div>

<div id="registerModal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h2><i class="fas fa-user-plus"></i> CrÃ©er un compte</h2>
            <button class="close-modal" onclick="closeModal('registerModal')">&times;</button>
        </div>
        <form id="registerForm">
            <div class="form-group">
                <label for="registerName">Nom complet</label>
                <input type="text" id="registerName" required>
            </div>
            <div class="form-group">
                <label for="registerEmail">Email</label>
                <input type="email" id="registerEmail" required>
            </div>
            <div class="form-group">
                <label for="registerPhone">NumÃ©ro de tÃ©lÃ©phone</label>
                <input type="tel" id="registerPhone">
            </div>
            <div class="form-group">
                <label for="registerAddress">Adresse</label>
                <textarea id="registerAddress" rows="3"></textarea>
            </div>
            <div class="form-group">
                <label for="registerPassword">Mot de passe</label>
                <input type="password" id="registerPassword" required>
            </div>
            <div class="form-group">
                <label for="registerConfirmPassword">Confirmer le mot de passe</label>
                <input type="password" id="registerConfirmPassword" required>
            </div>
            <button type="submit" class="form-submit">CrÃ©er mon compte</button>
        </form>
    </div>
</div>

<div id="cartModal" class="modal">
    <div class="modal-content cart-modal-content">
        <div class="modal-header">
            <h2><i class="fas fa-shopping-cart"></i> Mon panier</h2>
            <button class="close-modal" onclick="closeModal('cartModal')">&times;</button>
        </div>
        <div class="cart-items" id="cartItems">
            <!-- Articles du panier affichÃ©s dynamiquement -->
        </div>
        <div class="cart-total" id="cartTotal">Total: 0,00 $</div>
        <button class="form-submit" onclick="checkout()">Passer la commande</button>
    </div>
</div>

<!-- Panel d'administration -->
<div id="adminPanel" class="admin-panel">
    <div class="admin-header">
        <h2><i class="fas fa-user-shield"></i> Administration LD Organics</h2>
        <button class="admin-close" onclick="closeAdminPanel()">&times;</button>
    </div>
    <div class="admin-content">
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-value" id="totalProducts">0</div>
                <div class="stat-label">Produits</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="totalOrders">0</div>
                <div class="stat-label">Commandes</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="totalUsers">0</div>
                <div class="stat-label">Utilisateurs</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="totalRevenue">0,00 $</div>
                <div class="stat-label">Revenu Total</div>
            </div>
        </div>
        
        <!-- NOUVELLE SECTION POUR GÃRER LE CONTENU DES PAGES -->
        <div class="admin-section">
            <h3><i class="fas fa-file-alt"></i> Gestion du Contenu des Pages</h3>
            
            <div class="admin-actions">
                <button class="admin-btn primary" onclick="showEditAboutForm()">
                    <i class="fas fa-edit"></i> Modifier la page "Ã propos"
                </button>
                <button class="admin-btn primary" onclick="showEditContactForm()">
                    <i class="fas fa-edit"></i> Modifier la page "Contact"
                </button>
            </div>
        </div>
        
        <div class="admin-section">
            <h3><i class="fas fa-boxes"></i> Gestion des Produits</h3>
            <button class="admin-btn primary" onclick="showAddProductForm()">
                <i class="fas fa-plus"></i> Ajouter un produit
            </button>
            
            <div id="addProductForm" style="display: none; margin-top: 20px;">
                <form id="productForm" class="admin-form">
                    <div class="form-group">
                        <label for="productName">Nom du produit</label>
                        <input type="text" id="productName" required>
                    </div>
                    <div class="form-group">
                        <label for="productPrice">Prix ($)</label>
                        <input type="number" id="productPrice" step="0.01" required>
                    </div>
                    <div class="form-group">
                        <label for="productImage">URL de l'image</label>
                        <input type="url" id="productImage" required>
                    </div>
                    <div class="form-group full-width">
                        <label for="productDescription">Description</label>
                        <textarea id="productDescription" rows="3" required></textarea>
                    </div>
                    <div class="admin-actions">
                        <button type="submit" class="admin-btn primary">Enregistrer</button>
                        <button type="button" class="admin-btn secondary" onclick="hideAddProductForm()">Annuler</button>
                    </div>
                </form>
            </div>
            
            <table class="admin-table">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Image</th>
                        <th>Nom</th>
                        <th>Prix</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody id="adminProductsList">
                    <!-- Produits affichÃ©s dynamiquement -->
                </tbody>
            </table>
        </div>
        
        <div class="admin-section">
            <h3><i class="fas fa-users"></i> Gestion des Utilisateurs</h3>
            <table class="admin-table">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Nom</th>
                        <th>Email</th>
                        <th>TÃ©lÃ©phone</th>
                        <th>Statut</th>
                        <th>Permissions</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody id="adminUsersList">
                    <!-- Utilisateurs affichÃ©s dynamiquement -->
                </tbody>
            </table>
        </div>
        
        <div class="admin-section">
            <h3><i class="fas fa-shopping-cart"></i> Gestion des Commandes</h3>
            <table class="admin-table">
                <thead>
                    <tr>
                        <th>ID Commande</th>
                        <th>Client</th>
                        <th>Produits</th>
                        <th>Total</th>
                        <th>Date</th>
                        <th>Statut</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody id="adminOrdersList">
                    <!-- Commandes affichÃ©es dynamiquement -->
                </tbody>
            </table>
        </div>
    </div>
</div>

<!-- Panel Mon Compte -->
<div id="accountPanel" class="account-panel">
    <div class="account-header">
        <h2><i class="fas fa-user-circle"></i> Mon Compte</h2>
        <button class="account-close" onclick="closeAccountPanel()">&times;</button>
    </div>
    <div class="account-content">
        <div class="account-section">
            <h3><i class="fas fa-user"></i> Informations Personnelles</h3>
            <div class="account-info">
                <div class="form-group">
                    <label for="accountName">Nom complet</label>
                    <input type="text" id="accountName" disabled>
                </div>
                <div class="form-group">
                    <label for="accountEmail">Email</label>
                    <input type="email" id="accountEmail" disabled>
                </div>
                <div class="form-group">
                    <label for="accountPhone">NumÃ©ro de tÃ©lÃ©phone</label>
                    <input type="tel" id="accountPhone">
                </div>
                <div class="form-group full-width">
                    <label for="accountAddress">Adresse</label>
                    <textarea id="accountAddress" rows="3"></textarea>
                </div>
            </div>
            <div class="account-actions">
                <button class="admin-btn primary" onclick="toggleEditAccount()" id="editAccountBtn">
                    <i class="fas fa-edit"></i> Modifier mes informations
                </button>
                <button class="admin-btn success" onclick="saveAccountInfo()" id="saveAccountBtn" style="display: none;">
                    <i class="fas fa-save"></i> Enregistrer les modifications
                </button>
                <button class="admin-btn secondary" onclick="cancelEditAccount()" id="cancelAccountBtn" style="display: none;">
                    <i class="fas fa-times"></i> Annuler
                </button>
            </div>
        </div>
        
        <div class="account-section">
            <h3><i class="fas fa-history"></i> Historique des Commandes</h3>
            <div id="accountOrdersList">
                <!-- Commandes de l'utilisateur affichÃ©es dynamiquement -->
            </div>
        </div>
    </div>
</div>

<script>
// =============================================
// INITIALISATION DES VARIABLES GLOBALES
// =============================================
window.products = [];
window.cart = [];
window.currentUser = null;
window.isAdmin = false;
window.isOperator = false;
window.orders = [];
window.users = [];
window.pageContent = {
    about: {},
    contact: {}
};

// Identifiants admin sÃ©curisÃ©s
const ADMIN_CREDENTIALS = {
    email: "admin@ldorganics.com",
    password: "admin123"
};

// Identifiants opÃ©rateur
const OPERATOR_CREDENTIALS = {
    email: "operator@ldorganics.com",
    password: "operator123"
};

// Permissions disponibles
const availablePermissions = [
    { id: 'view_products', name: 'Voir les produits' },
    { id: 'purchase', name: 'Effectuer des achats' },
    { id: 'manage_own_orders', name: 'GÃ©rer ses propres commandes' },
    { id: 'manage_all_orders', name: 'GÃ©rer toutes les commandes' },
    { id: 'manage_users', name: 'GÃ©rer les utilisateurs' },
    { id: 'manage_products', name: 'GÃ©rer les produits' },
    { id: 'operator_orders', name: 'OpÃ©rateur de commandes' }
];

// Statuts de commande
const ORDER_STATUS = {
    PENDING: 'pending',
    PROCESSING: 'processing',
    SHIPPED: 'shipped',
    DELIVERED: 'delivered',
    CANCELLED: 'cancelled'
};

// Contenu par dÃ©faut pour les pages
const defaultPageContent = {
    about: {
        title: "Notre Histoire & Engagement",
        subtitle: "FondÃ©e en 2020, LD Organics est nÃ©e d'une passion pour le bien-Ãªtre naturel",
        content: `
            <div class="about-hero">
                <h1>Notre Histoire & Engagement</h1>
                <p>FondÃ©e en 2020, LD Organics est nÃ©e d'une passion pour le bien-Ãªtre naturel et d'une conviction profonde : chacun mÃ©rite d'avoir accÃ¨s Ã  des produits au CBD de la plus haute qualitÃ©.</p>
            </div>
            
            <div class="about-content">
                <div class="about-text">
                    <h2>Notre Mission</h2>
                    <p>Notre mission est de dÃ©mocratiser l'accÃ¨s au CBD thÃ©rapeutique tout en maintenant des standards d'excellence inÃ©galÃ©s. Chaque produit que nous proposons est le rÃ©sultat de recherches approfondies, de tests rigoureux et d'un engagement indÃ©fectible envers la qualitÃ©.</p>
                    
                    <p>Nous croyons fermement que le bien-Ãªtre devrait Ãªtre accessible Ã  tous, c'est pourquoi nous nous engageons Ã  offrir des produits naturels, biologiques et testÃ©s en laboratoire Ã  des prix justes.</p>
                    
                    <p>Notre Ã©quipe d'experts travaille quotidiennement pour vous proposer des solutions innovantes et efficaces, dans le respect de l'environnement et des normes Ã©thiques les plus strictes.</p>
                </div>
                
                <div class="about-image">
                    <img src="https://i.postimg.cc/BncyKD9D/Design-sans-titre-1.png" alt="LD Organics - Notre engagement qualitÃ©">
                </div>
            </div>
            
            <div class="about-features">
                <h3>Pourquoi Nous Choisir ?</h3>
                <div class="feature-grid">
                    <div class="feature-item">
                        <div class="feature-icon">
                            <i class="fas fa-leaf"></i>
                        </div>
                        <h4>100% Biologique</h4>
                        <p>Tous nos produits sont issus de l'agriculture biologique, sans pesticides ni produits chimiques. Nous privilÃ©gions les ingrÃ©dients naturels pour votre santÃ©.</p>
                    </div>
                    <div class="feature-item">
                        <div class="feature-icon">
                            <i class="fas fa-flask"></i>
                        </div>
                        <h4>TestÃ© en Laboratoire</h4>
                        <p>Chaque lot est analysÃ© par des laboratoires indÃ©pendants pour garantir puretÃ©, concentration et absence de contaminants. Transparence totale.</p>
                    </div>
                    <div class="feature-item">
                        <div class="feature-icon">
                            <i class="fas fa-truck"></i>
                        </div>
                        <h4>Livraison Rapide</h4>
                        <p>ExpÃ©dition sous 24h et livraison discrÃ¨te partout en France et en Europe. Emballages Ã©cologiques et sÃ©curisÃ©s pour prÃ©server la qualitÃ©.</p>
                    </div>
                    <div class="feature-item">
                        <div class="feature-icon">
                            <i class="fas fa-headset"></i>
                        </div>
                        <h4>Support Expert</h4>
                        <p>Notre Ã©quipe de spÃ©cialistes est Ã  votre Ã©coute pour vous conseiller et vous accompagner dans votre dÃ©marche de bien-Ãªtre au quotidien.</p>
                    </div>
                </div>
            </div>
        `,
        sections: [
            {
                id: 1,
                title: 'Notre Mission',
                content: 'Notre mission est de dÃ©mocratiser l\'accÃ¨s au CBD thÃ©rapeutique tout en maintenant des standards d\'excellence inÃ©galÃ©s. Chaque produit que nous proposons est le rÃ©sultat de recherches approfondies, de tests rigoureux et d\'un engagement indÃ©fectible envers la qualitÃ©.',
                image: '',
                position: 'left'
            }
        ],
        features: [
            {
                id: 1,
                icon: 'fas fa-leaf',
                title: '100% Biologique',
                description: 'Tous nos produits sont issus de l\'agriculture biologique, sans pesticides ni produits chimiques. Nous privilÃ©gions les ingrÃ©dients naturels pour votre santÃ©.'
            },
            {
                id: 2,
                icon: 'fas fa-flask',
                title: 'TestÃ© en Laboratoire',
                description: 'Chaque lot est analysÃ© par des laboratoires indÃ©pendants pour garantir puretÃ©, concentration et absence de contaminants. Transparence totale.'
            },
            {
                id: 3,
                icon: 'fas fa-truck',
                title: 'Livraison Rapide',
                description: 'ExpÃ©dition sous 24h et livraison discrÃ¨te partout en France et en Europe. Emballages Ã©cologiques et sÃ©curisÃ©s pour prÃ©server la qualitÃ©.'
            },
            {
                id: 4,
                icon: 'fas fa-headset',
                title: 'Support Expert',
                description: 'Notre Ã©quipe de spÃ©cialistes est Ã  votre Ã©coute pour vous conseiller et vous accompagner dans votre dÃ©marche de bien-Ãªtre au quotidien.'
            }
        ]
    },
    contact: {
        title: "Contactez-nous",
        subtitle: "Nous sommes Ã  votre Ã©coute",
        content: `
            <h2 class="section-title">Contactez-nous</h2>
            <div style="text-align: center; padding: 60px 0;">
                <h3 style="color: var(--primary); margin-bottom: 20px;">Nous sommes Ã  votre Ã©coute</h3>
                <p style="font-size: 1.2rem; color: var(--dark-gray); max-width: 600px; margin: 0 auto 30px;">
                    Pour toute question concernant nos produits ou vos commandes, n'hÃ©sitez pas Ã  nous contacter.
                </p>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 30px; margin-top: 50px;">
                    <div class="feature-item">
                        <div class="feature-icon">
                            <i class="fas fa-envelope"></i>
                        </div>
                        <h4>Email</h4>
                        <p>contact@ldorganics.com</p>
                    </div>
                    <div class="feature-item">
                        <div class="feature-icon">
                            <i class="fas fa-phone"></i>
                        </div>
                        <h4>TÃ©lÃ©phone</h4>
                        <p>+33 1 23 45 67 89</p>
                    </div>
                    <div class="feature-item">
                        <div class="feature-icon">
                            <i class="fas fa-clock"></i>
                        </div>
                        <h4>Horaires</h4>
                        <p>Lun - Ven: 9h-18h<br>Sam: 10h-16h</p>
                    </div>
                </div>
            </div>
        `
    }
};

// DonnÃ©es des produits avec vos images et prix
const defaultProducts = [
    {
        id: 1,
        name: "Huile de CBD Premium",
        price: 10.00,
        image: "https://i.goopics.net/4ngzd9.png",
        description: "Notre huile de CBD premium est extraite de plants de chanvre biologiques cultivÃ©s en Suisse. Elle offre une concentration parfaite pour un usage quotidien et un bien-Ãªtre optimal.",
        features: ["100% Naturelle", "Sans THC", "FabriquÃ©e en Suisse", "TestÃ©e en laboratoire", "10ml par flacon"],
        usage: "Agiter avant utilisation. Prendre 2-3 gouttes sous la langue, maintenir 60 secondes avant d'avaler."
    },
    {
        id: 2,
        name: "Lotion CBD Hydratante",
        price: 10.00,
        image: "https://i.goopics.net/ken4t2.png",
        description: "Lotion corporelle enrichie au CBD pour une hydratation profonde et apaisante. FormulÃ©e avec des ingrÃ©dients naturels comme l'aloe vera et la vitamine E.",
        features: ["Hydratation intense", "Aloe Vera", "Vitamine E", "Convient peaux sensibles", "Parfum naturel"],
        usage: "Appliquer sur peau propre et sÃ¨che. Masser doucement jusqu'Ã  absorption complÃ¨te."
    },
    {
        id: 3,
        name: "Sachets Vides RÃ©utilisables",
        price: 3.00,
        image: "https://i.goopics.net/6cq26n.png",
        description: "Sachets en coton organique rÃ©utilisables, parfaits pour conserver vos herbes et plantes mÃ©dicinales. Respirants et Ã©cologiques.",
        features: ["Coton biologique", "RÃ©utilisable", "Ãcologique", "Taille standard", "Fermeture sÃ©curisÃ©e"],
        usage: "Remplir avec vos herbes prÃ©fÃ©rÃ©es, fermer soigneusement. Conserver Ã  l'abri de l'humiditÃ©."
    },
    {
        id: 4,
        name: "Joint PrÃ©-roulÃ© CBD",
        price: 10.00,
        image: "https://i.goopics.net/7u44os.png",
        description: "Joint prÃ©-roulÃ© artisanal contenant des fleurs de CBD de haute qualitÃ©. Chaque joint est soigneusement confectionnÃ©.",
        features: ["Fleurs premium", "Roulage artisanal", "Papier naturel", "Dosage contrÃ´lÃ©", "Sans additifs"],
        usage: "Allumer dÃ©licatement et inhaler lentement. Consommer avec modÃ©ration dans un environnement calme."
    },
    {
        id: 5,
        name: "Feuilles de ThÃ© InfusÃ©es CBD",
        price: 24.00,
        image: "https://i.goopics.net/vkblb7.png",
        description: "MÃ©lange exclusif de thÃ© vert premium infusÃ© au CBD. Une faÃ§on dÃ©licieuse et relaxante de profiter des bienfaits du CBD.",
        features: ["ThÃ© vert premium", "Infusion naturelle", "ArÃ´me dÃ©licat", "20 sachets", "Antioxydants naturels"],
        usage: "Infuser 1 sachet dans 250ml d'eau chaude (80Â°C) pendant 3-5 minutes. Boire 1 Ã  2 fois par jour."
    },
    {
        id: 6,
        name: "Sacs en Papier Kraft Ãcologiques",
        price: 2.00,
        image: "https://i.goopics.net/phhwrh.png",
        description: "Sacs en papier kraft 100% biodÃ©gradables, idÃ©aux pour l'emballage de vos produits. Respectueux de l'environnement.",
        features: ["100% BiodÃ©gradable", "RÃ©sistant", "Taille polyvalente", "Ãcologique", "FabriquÃ© en France"],
        usage: "Utiliser pour emballer vos produits secs. Conserver dans un endroit sec Ã  l'abri de l'humiditÃ©."
    },
    {
        id: 7,
        name: "Sucettes au CBD Gourmandes",
        price: 8.00,
        image: "https://i.goopics.net/twp1aj.png",
        description: "DÃ©licieuses sucettes au CBD avec diffÃ©rents parfums fruitÃ©s. Chaque sucette contient une dose prÃ©cise de CBD.",
        features: ["5 parfums disponibles", "Sans sucre raffinÃ©", "10mg CBD par sucette", "VÃ©gÃ©taliennes", "FabriquÃ© artisanalement"],
        usage: "Sucer lentement la sucette jusqu'Ã  dissolution complÃ¨te. Maximum 2 sucettes par jour."
    },
    {
        id: 8,
        name: "Chillma - MÃ©lange Relaxant",
        price: 10.00,
        image: "https://i.goopics.net/bij1lq.png",
        description: "MÃ©lange exclusif de plantes et de CBD spÃ©cialement formulÃ© pour la dÃ©tente et la relaxation.",
        features: ["MÃ©lange de plantes", "PropriÃ©tÃ©s relaxantes", "ArÃ´me naturel", "Sans conservateurs", "20g par sachet"],
        usage: "Utiliser selon vos prÃ©fÃ©rences. Peut Ãªtre infusÃ© en thÃ© ou utilisÃ© dans un vaporisateur."
    },
    {
        id: 9,
        name: "Cookies au CBD Chocolat-Noisette",
        price: 10.00,
        image: "https://i.goopics.net/t1gbd9.png",
        description: "Cookies artisanaux au chocolat et noisette infusÃ©s au CBD. Une gourmandise saine qui allie plaisir gustatif et bien-Ãªtre.",
        features: ["Artisanal", "Chocolat noir", "Noisettes torrÃ©fiÃ©es", "15mg CBD per cookie", "Sans gluten"],
        usage: "DÃ©guster 1 cookie par jour de prÃ©fÃ©rence en aprÃ¨s-midi. Conserver au frais et au sec."
    }
];

// =============================================
// FONCTIONS PRINCIPALES
// =============================================

function showSection(sectionId) {
    console.log('Chargement de la section:', sectionId);
    
    // Masquer toutes les sections
    const sections = document.querySelectorAll('main > section');
    sections.forEach(section => {
        section.style.display = 'none';
    });
    
    // Afficher la section sÃ©lectionnÃ©e
    const targetSection = document.getElementById(sectionId);
    if (targetSection) {
        targetSection.style.display = 'block';
        
        // Charger le contenu appropriÃ©
        if (sectionId === 'products') {
            displayProducts();
        } else if (sectionId === 'about') {
            loadAboutContent();
        } else if (sectionId === 'contact') {
            loadContactContent();
        }
    }
    
    // Mettre Ã  jour la navigation active
    const navLinks = document.querySelectorAll('nav a');
    navLinks.forEach(link => {
        link.classList.remove('nav-active');
        if (link.getAttribute('href') === `#${sectionId}`) {
            link.classList.add('nav-active');
        }
    });
    
    // Fermer le dropdown menu
    const dropdownMenu = document.getElementById('dropdownMenu');
    if (dropdownMenu) {
        dropdownMenu.classList.remove('show');
    }
}

// FONCTIONS POUR GÃRER LE CONTENU DES PAGES
function loadPageContent() {
    const savedContent = localStorage.getItem('ldOrganicsPageContent');
    if (savedContent) {
        window.pageContent = JSON.parse(savedContent);
    } else {
        window.pageContent = defaultPageContent;
        savePageContent();
    }
}

function savePageContent() {
    localStorage.setItem('ldOrganicsPageContent', JSON.stringify(window.pageContent));
}

function loadAboutContent() {
    const aboutContent = document.getElementById('aboutContent');
    if (aboutContent && window.pageContent.about && window.pageContent.about.content) {
        aboutContent.innerHTML = window.pageContent.about.content;
    } else {
        aboutContent.innerHTML = defaultPageContent.about.content;
    }
}

function loadContactContent() {
    const contactContent = document.getElementById('contactContent');
    if (contactContent && window.pageContent.contact && window.pageContent.contact.content) {
        contactContent.innerHTML = window.pageContent.contact.content;
    } else {
        contactContent.innerHTML = defaultPageContent.contact.content;
    }
}

// FONCTION D'INITIALISATION
function initializeApplication() {
    console.log('ð Initialisation de l application');
    
    // Charger les donnÃ©es
    loadAllData();
    loadPageContent();
    
    // Initialiser les comptes systÃ¨me
    initializeAdminAccount();
    initializeOperatorAccount();
    
    // Afficher les produits
    displayProducts();
    updateCartCount();
    
    // Configurer les Ã©vÃ©nements
    setupEventListeners();
    updateUserInterface();
    
    // Forcer l'affichage de la section Accueil
    showSection('home');
    
    console.log('â Application initialisÃ©e avec succÃ¨s');
}

// FONCTION DE SAUVEGARDE AUTOMATIQUE AMÃLIORÃE
function saveAllData() {
    try {
        // VÃ©rifier que les donnÃ©es sont valides avant sauvegarde
        const dataToSave = {
            products: Array.isArray(window.products) ? window.products.filter(p => p && p.id) : [],
            users: Array.isArray(window.users) ? window.users.filter(u => u && u.id) : [],
            orders: Array.isArray(window.orders) ? window.orders.filter(o => o && o.id) : [],
            cart: Array.isArray(window.cart) ? window.cart.filter(item => item && item.id) : []
        };
        
        localStorage.setItem('ldOrganicsProducts', JSON.stringify(dataToSave.products));
        localStorage.setItem('ldOrganicsUsers', JSON.stringify(dataToSave.users));
        localStorage.setItem('ldOrganicsOrders', JSON.stringify(dataToSave.orders));
        localStorage.setItem('ldOrganicsCart', JSON.stringify(dataToSave.cart));
        
        console.log('ð¾ DonnÃ©es sauvegardÃ©es avec succÃ¨s');
    } catch (e) {
        console.error('â Erreur lors de la sauvegarde:', e);
        showNotification('Erreur lors de la sauvegarde des donnÃ©es', 'error');
    }
}

// FONCTIONS DE BASE AVEC SAUVEGARDE AUTOMATIQUE
function loadAllData() {
    try {
        // Produits
        const savedProducts = localStorage.getItem('ldOrganicsProducts');
        if (savedProducts) {
            const parsed = JSON.parse(savedProducts);
            if (Array.isArray(parsed) && parsed.length > 0) {
                window.products = parsed.filter(p => p && p.id && p.name);
            } else {
                window.products = [...defaultProducts];
            }
        } else {
            window.products = [...defaultProducts];
        }
        
        // Utilisateurs
        const savedUsers = localStorage.getItem('ldOrganicsUsers');
        if (savedUsers) {
            const parsed = JSON.parse(savedUsers);
            if (Array.isArray(parsed)) {
                window.users = parsed.filter(u => u && u.id);
            }
        }
        
        // Commandes
        const savedOrders = localStorage.getItem('ldOrganicsOrders');
        if (savedOrders) {
            const parsed = JSON.parse(savedOrders);
            if (Array.isArray(parsed)) {
                window.orders = parsed.filter(o => o && o.id);
            }
        }
        
        // Panier
        const savedCart = localStorage.getItem('ldOrganicsCart');
        if (savedCart) {
            const parsed = JSON.parse(savedCart);
            if (Array.isArray(parsed)) {
                window.cart = parsed.filter(item => item && item.id);
            }
        }
    } catch (e) {
        console.error('Erreur lors du chargement des donnÃ©es:', e);
        // RÃ©initialiser avec des valeurs par dÃ©faut
        window.products = [...defaultProducts];
        window.users = [];
        window.orders = [];
        window.cart = [];
    }
}

function initializeAdminAccount() {
    const adminExists = window.users.find(u => u.email === ADMIN_CREDENTIALS.email);
    
    if (!adminExists) {
        const adminUser = {
            id: window.users.length > 0 ? Math.max(...window.users.map(u => u.id || 0)) + 1 : 1,
            name: 'Administrateur',
            email: ADMIN_CREDENTIALS.email,
            phone: '',
            address: '',
            password: ADMIN_CREDENTIALS.password,
            status: 'approved',
            permissions: ['view_products', 'purchase', 'manage_own_orders', 'manage_all_orders', 'manage_users', 'manage_products'],
            registrationDate: new Date().toISOString().split('T')[0],
            isAdmin: true
        };
        
        window.users.push(adminUser);
        saveAllData();
    }
}

function initializeOperatorAccount() {
    const operatorExists = window.users.find(u => u.email === OPERATOR_CREDENTIALS.email);
    
    if (!operatorExists) {
        const operatorUser = {
            id: window.users.length > 0 ? Math.max(...window.users.map(u => u.id || 0)) + 1 : 2,
            name: 'OpÃ©rateur Commandes',
            email: OPERATOR_CREDENTIALS.email,
            phone: '',
            address: '',
            password: OPERATOR_CREDENTIALS.password,
            status: 'approved',
            permissions: ['view_products', 'operator_orders'],
            registrationDate: new Date().toISOString().split('T')[0],
            isOperator: true
        };
        
        if (!window.users.find(u => u.id === operatorUser.id)) {
            window.users.push(operatorUser);
            saveAllData();
        }
    }
}

// FONCTION DISPLAYPRODUCTS
function displayProducts() {
    const productsGrid = document.getElementById('featuredProductsGrid');
    if (!productsGrid) {
        console.error('Element featuredProductsGrid non trouvÃ©');
        return;
    }
    
    productsGrid.innerHTML = '';

    // VÃ©rification sÃ©curisÃ©e des produits
    if (!window.products || !Array.isArray(window.products) || window.products.length === 0) {
        productsGrid.innerHTML = '<p style="text-align: center; padding: 40px; grid-column: 1 / -1; color: var(--dark-gray);">Aucun produit disponible pour le moment</p>';
        return;
    }

    window.products.forEach(product => {
        // VÃ©rification de la validitÃ© du produit
        if (!product || !product.id || !product.name) {
            console.warn('Produit invalide ignorÃ©:', product);
            return;
        }
        
        const productCard = document.createElement('div');
        productCard.className = 'product-card';
        productCard.innerHTML = `
            <div class="product-image">
                <img src="${product.image || 'https://via.placeholder.com/300x200?text=Image+Manquante'}" 
                     alt="${product.name}" 
                     loading="lazy"
                     onerror="this.onerror=null; this.src='https://via.placeholder.com/300x200?text=Erreur+Image'">
            </div>
            <div class="product-info">
                <h3>${product.name}</h3>
                <div class="product-price">${(product.price || 0).toFixed(2)} $</div>
                <button class="featured-btn" onclick="addToCart(${product.id})">
                    <i class="fas fa-cart-plus"></i> Ajouter au panier
                </button>
                <button class="featured-btn primary" onclick="showProductDetails(${product.id})">
                    <i class="fas fa-info-circle"></i> DÃ©tails
                </button>
            </div>
        `;
        productsGrid.appendChild(productCard);
    });
}

// FONCTION ADDTOCART
function addToCart(productId) {
    console.log('Ajout au panier:', productId);
    
    // VÃ©rifications de sÃ©curitÃ©
    if (!window.products || !Array.isArray(window.products)) {
        console.error('Produits non initialisÃ©s');
        showNotification('Erreur: produits non disponibles', 'error');
        return;
    }

    const product = window.products.find(p => p && p.id === productId);
    if (!product) {
        showNotification('Produit non trouvÃ©', 'error');
        return;
    }

    // Initialiser le panier si nÃ©cessaire
    if (!window.cart || !Array.isArray(window.cart)) {
        window.cart = [];
    }

    const existingItem = window.cart.find(item => item && item.id === productId);

    if (existingItem) {
        existingItem.quantity = (existingItem.quantity || 0) + 1;
    } else {
        window.cart.push({
            id: product.id,
            name: product.name || 'Produit sans nom',
            price: product.price || 0,
            image: product.image || '',
            quantity: 1
        });
    }

    updateCartCount();
    saveAllData();
    showNotification('Produit ajoutÃ© au panier !', 'success');
}

function setupEventListeners() {
    const clientSpaceLink = document.getElementById('clientSpaceLink');
    if (clientSpaceLink) {
        clientSpaceLink.addEventListener('click', function() {
            const dropdownMenu = document.getElementById('dropdownMenu');
            if (dropdownMenu) {
                dropdownMenu.classList.toggle('show');
            }
        });
    }

    document.addEventListener('click', function(event) {
        const dropdownMenu = document.getElementById('dropdownMenu');
        const clientSpace = document.querySelector('.client-space');
        
        if (dropdownMenu && clientSpace && !event.target.closest('.client-space')) {
            dropdownMenu.classList.remove('show');
        }
    });

    const createAccountOption = document.getElementById('createAccountOption');
    if (createAccountOption) {
        createAccountOption.addEventListener('click', function(e) {
            e.preventDefault();
            const dropdownMenu = document.getElementById('dropdownMenu');
            if (dropdownMenu) dropdownMenu.classList.remove('show');
            const registerModal = document.getElementById('registerModal');
            if (registerModal) registerModal.style.display = 'flex';
        });
    }

    const loginOption = document.getElementById('loginOption');
    if (loginOption) {
        loginOption.addEventListener('click', function(e) {
            e.preventDefault();
            const dropdownMenu = document.getElementById('dropdownMenu');
            if (dropdownMenu) dropdownMenu.classList.remove('show');
            const loginModal = document.getElementById('loginModal');
            if (loginModal) loginModal.style.display = 'flex';
        });
    }

    const myAccountOption = document.getElementById('myAccountOption');
    if (myAccountOption) {
        myAccountOption.addEventListener('click', function(e) {
            e.preventDefault();
            const dropdownMenu = document.getElementById('dropdownMenu');
            if (dropdownMenu) dropdownMenu.classList.remove('show');
            openAccountPanel();
        });
    }

    const loginForm = document.getElementById('loginForm');
    if (loginForm) {
        loginForm.addEventListener('submit', function(e) {
            e.preventDefault();
            handleLogin();
        });
    }

    const registerForm = document.getElementById('registerForm');
    if (registerForm) {
        registerForm.addEventListener('submit', function(e) {
            e.preventDefault();
            handleRegister();
        });
    }

    const adminLink = document.getElementById('adminLink');
    if (adminLink) {
        adminLink.addEventListener('click', function(e) {
            e.preventDefault();
            const dropdownMenu = document.getElementById('dropdownMenu');
            if (dropdownMenu) dropdownMenu.classList.remove('show');
            openAdminPanel();
        });
    }

    const logoutOption = document.getElementById('logoutOption');
    if (logoutOption) {
        logoutOption.addEventListener('click', function(e) {
            e.preventDefault();
            const dropdownMenu = document.getElementById('dropdownMenu');
            if (dropdownMenu) dropdownMenu.classList.remove('show');
            logout();
        });
    }

    const productForm = document.getElementById('productForm');
    if (productForm) {
        productForm.addEventListener('submit', function(e) {
            e.preventDefault();
            addNewProduct();
        });
    }
}

function handleLogin() {
    const email = document.getElementById('loginEmail').value;
    const password = document.getElementById('loginPassword').value;
    
    if (!email || !password) {
        showNotification('Veuillez remplir tous les champs', 'error');
        return;
    }
    
    // VÃ©rification spÃ©ciale pour l'admin
    if (email === ADMIN_CREDENTIALS.email && password === ADMIN_CREDENTIALS.password) {
        let adminUser = window.users.find(u => u.email === ADMIN_CREDENTIALS.email);
        
        if (!adminUser) {
            initializeAdminAccount();
            adminUser = window.users.find(u => u.email === ADMIN_CREDENTIALS.email);
        }
        
        if (adminUser) {
            window.currentUser = {
                id: adminUser.id,
                name: adminUser.name,
                email: adminUser.email,
                phone: adminUser.phone || '',
                address: adminUser.address || '',
                permissions: adminUser.permissions || []
            };
            
            window.isAdmin = true;
            window.isOperator = false;
            updateUserInterface();
            closeModal('loginModal');
            showNotification('Connexion administrateur rÃ©ussie !', 'success');
            document.getElementById('loginForm').reset();
            return;
        }
    }
    
    // VÃ©rification spÃ©ciale pour l'opÃ©rateur
    if (email === OPERATOR_CREDENTIALS.email && password === OPERATOR_CREDENTIALS.password) {
        let operatorUser = window.users.find(u => u.email === OPERATOR_CREDENTIALS.email);
        
        if (!operatorUser) {
            initializeOperatorAccount();
            operatorUser = window.users.find(u => u.email === OPERATOR_CREDENTIALS.email);
        }
        
        if (operatorUser) {
            window.currentUser = {
                id: operatorUser.id,
                name: operatorUser.name,
                email: operatorUser.email,
                phone: operatorUser.phone || '',
                address: operatorUser.address || '',
                permissions: operatorUser.permissions || []
            };
            
            window.isAdmin = false;
            window.isOperator = true;
            updateUserInterface();
            closeModal('loginModal');
            showNotification('Connexion opÃ©rateur rÃ©ussie !', 'success');
            document.getElementById('loginForm').reset();
            return;
        }
    }
    
    // Rechercher l'utilisateur normal
    const user = window.users.find(u => u.email === email);
    
    if (!user) {
        showNotification('Aucun compte trouvÃ© avec cet email', 'error');
        return;
    }
    
    if (user.password !== password) {
        showNotification('Mot de passe incorrect', 'error');
        return;
    }
    
    if (user.status === 'pending') {
        showNotification('Votre compte est en attente d\'approbation par l\'administrateur', 'warning');
        return;
    }
    
    if (user.status === 'rejected') {
        showNotification('Votre compte a Ã©tÃ© rejetÃ© par l\'administrateur', 'error');
        return;
    }
    
    window.currentUser = {
        id: user.id,
        name: user.name,
        email: user.email,
        phone: user.phone || '',
        address: user.address || '',
        permissions: user.permissions || []
    };
    
    window.isAdmin = user.isAdmin || (user.permissions && user.permissions.includes('manage_users'));
    window.isOperator = user.isOperator || (user.permissions && user.permissions.includes('operator_orders'));
    
    updateUserInterface();
    closeModal('loginModal');
    showNotification('Connexion rÃ©ussie !', 'success');
    document.getElementById('loginForm').reset();
}

function checkout() {
    if (!window.cart || window.cart.length === 0) {
        showNotification('Votre panier est vide', 'error');
        return;
    }
    
    if (!window.currentUser) {
        showNotification('Veuillez vous connecter pour passer commande', 'error');
        const loginModal = document.getElementById('loginModal');
        if (loginModal) loginModal.style.display = 'flex';
        closeModal('cartModal');
        return;
    }
    
    if (!window.currentUser.permissions || !window.currentUser.permissions.includes('purchase')) {
        showNotification('Vous n\'avez pas la permission d\'effectuer des achats', 'error');
        return;
    }
    
    const total = window.cart.reduce((sum, item) => sum + ((item.price || 0) * (item.quantity || 0)), 0);
    
    const newOrder = {
        id: window.orders.length > 0 ? Math.max(...window.orders.map(o => o.id || 0)) + 1 : 1,
        customerName: window.currentUser.name,
        customerEmail: window.currentUser.email,
        customerPhone: window.currentUser.phone,
        customerAddress: window.currentUser.address,
        items: window.cart.map(item => ({
            id: item.id,
            name: item.name,
            price: item.price,
            quantity: item.quantity
        })),
        total: total,
        date: new Date().toISOString().split('T')[0],
        status: ORDER_STATUS.PENDING,
        statusHistory: [{
            status: ORDER_STATUS.PENDING,
            date: new Date().toISOString(),
            changedBy: 'SystÃ¨me'
        }]
    };
    
    window.orders.push(newOrder);
    saveAllData();
    
    showNotification(`Commande passÃ©e avec succÃ¨s ! Total: ${total.toFixed(2)} $`, 'success');
    
    window.cart = [];
    updateCartCount();
    updateCartModal();
    saveAllData();
    closeModal('cartModal');
}

function removeFromCart(productId) {
    window.cart = window.cart.filter(item => item.id !== productId);
    updateCartCount();
    updateCartModal();
    saveAllData();
}

function updateQuantity(productId, change) {
    const item = window.cart.find(item => item.id === productId);
    if (item) {
        item.quantity += change;
        if (item.quantity <= 0) {
            removeFromCart(productId);
        } else {
            updateCartCount();
            updateCartModal();
            saveAllData();
        }
    }
}

function updateCartCount() {
    const count = window.cart.reduce((total, item) => total + (item.quantity || 0), 0);
    const cartCountElement = document.querySelector('.cart-count');
    if (cartCountElement) {
        cartCountElement.textContent = count;
    }
}

function updateCartModal() {
    const cartItems = document.getElementById('cartItems');
    const cartTotal = document.getElementById('cartTotal');
    
    if (!cartItems || !cartTotal) return;
    
    cartItems.innerHTML = '';
    
    if (window.cart.length === 0) {
        cartItems.innerHTML = '<p style="text-align: center; padding: 40px;">Votre panier est vide</p>';
        cartTotal.textContent = 'Total: 0,00 $';
        return;
    }

    let total = 0;
    
    window.cart.forEach(item => {
        const itemTotal = (item.price || 0) * (item.quantity || 0);
        total += itemTotal;
        
        const cartItem = document.createElement('div');
        cartItem.className = 'cart-item';
        cartItem.innerHTML = `
            <div class="cart-item-image">
                <img src="${item.image || 'https://via.placeholder.com/80x80?text=Image'}" alt="${item.name || 'Produit'}" loading="lazy">
            </div>
            <div class="cart-item-info">
                <h4>${item.name || 'Produit'}</h4>
                <div class="cart-item-price">${(item.price || 0).toFixed(2)} $</div>
                <div class="cart-item-quantity">
                    <button class="quantity-btn" onclick="updateQuantity(${item.id}, -1)">-</button>
                    <span>${item.quantity || 0}</span>
                    <button class="quantity-btn" onclick="updateQuantity(${item.id}, 1)">+</button>
                    <button class="featured-btn" onclick="removeFromCart(${item.id})" style="margin-left: auto;">
                        <i class="fas fa-trash"></i>
                    </button>
                </div>
            </div>
        `;
        cartItems.appendChild(cartItem);
    });
    
    cartTotal.textContent = `Total: ${total.toFixed(2)} $`;
}

function openCartModal() {
    updateCartModal();
    const cartModal = document.getElementById('cartModal');
    if (cartModal) {
        cartModal.style.display = 'flex';
    }
}

function closeModal(modalId) {
    const modal = document.getElementById(modalId);
    if (modal) {
        modal.style.display = 'none';
    }
}

function showProductDetails(productId) {
    const product = window.products.find(p => p.id === productId);
    if (!product) return;
    
    const alertContent = document.createElement('div');
    alertContent.className = 'custom-alert-content';
    alertContent.innerHTML = `
        <div class="product-details">
            <img src="${product.image || 'https://via.placeholder.com/300x300?text=Image+Manquante'}" alt="${product.name}" class="product-details-image" loading="lazy">
            <h3>${product.name}</h3>
            <div class="product-details-price">${(product.price || 0).toFixed(2)} $</div>
            <div class="product-description">
                <p>${product.description || 'Aucune description disponible.'}</p>
            </div>
            <div class="product-features">
                <h4>CaractÃ©ristiques :</h4>
                <ul>
                    ${(product.features || ['Aucune caractÃ©ristique disponible']).map(feature => `<li>${feature}</li>`).join('')}
                </ul>
            </div>
            <div class="usage-tips">
                <h4>Mode d'utilisation :</h4>
                <p>${product.usage || 'Aucune information d\'utilisation disponible.'}</p>
            </div>
            <button class="featured-btn primary" onclick="addToCart(${product.id}); closeCustomAlert();" style="margin-top: 20px;">
                <i class="fas fa-cart-plus"></i> Ajouter au panier
            </button>
            <button class="featured-btn" onclick="closeCustomAlert()" style="margin-top: 10px;">
                <i class="fas fa-times"></i> Fermer
            </button>
        </div>
    `;
    
    showCustomAlert(alertContent);
}

function showCustomAlert(content) {
    const alert = document.createElement('div');
    alert.className = 'custom-alert';
    alert.id = 'customAlert';
    alert.appendChild(content);
    document.body.appendChild(alert);
}

function closeCustomAlert() {
    const alert = document.getElementById('customAlert');
    if (alert) {
        alert.remove();
    }
}

function showNotification(message, type = 'info') {
    const notification = document.createElement('div');
    notification.className = `notification ${type}`;
    notification.style.cssText = `
        position: fixed;
        top: 20px;
        right: 20px;
        padding: 15px 20px;
        background: ${type === 'success' ? '#4caf50' : type === 'error' ? '#f44336' : '#2196f3'};
        color: white;
        border-radius: 8px;
        z-index: 10000;
        box-shadow: 0 4px 20px rgba(0,0,0,0.15);
        animation: slideInRight 0.3s ease;
    `;
    notification.textContent = message;
    
    document.body.appendChild(notification);
    
    setTimeout(() => {
        if (notification.parentNode) {
            notification.remove();
        }
    }, 3000);
}

function handleRegister() {
    const name = document.getElementById('registerName').value;
    const email = document.getElementById('registerEmail').value;
    const phone = document.getElementById('registerPhone').value;
    const address = document.getElementById('registerAddress').value;
    const password = document.getElementById('registerPassword').value;
    const confirmPassword = document.getElementById('registerConfirmPassword').value;
    
    if (password !== confirmPassword) {
        showNotification('Les mots de passe ne correspondent pas', 'error');
        return;
    }
    
    if (name && email && password) {
        if (window.users.find(u => u.email === email)) {
            showNotification('Un compte avec cet email existe dÃ©jÃ ', 'error');
            return;
        }
        
        const newUser = {
            id: window.users.length > 0 ? Math.max(...window.users.map(u => u.id || 0)) + 1 : 3,
            name: name,
            email: email,
            phone: phone || '',
            address: address || '',
            password: password,
            status: 'pending',
            permissions: ['view_products'],
            registrationDate: new Date().toISOString().split('T')[0],
            isAdmin: false,
            isOperator: false
        };
        
        window.users.push(newUser);
        saveAllData();
        
        showNotification('Compte crÃ©Ã© avec succÃ¨s ! En attente d\'approbation par l\'administrateur.', 'success');
        closeModal('registerModal');
        
        document.getElementById('registerForm').reset();
    } else {
        showNotification('Veuillez remplir tous les champs obligatoires', 'error');
    }
}

function logout() {
    window.currentUser = null;
    window.isAdmin = false;
    window.isOperator = false;
    updateUserInterface();
    showNotification('DÃ©connexion rÃ©ussie', 'info');
}

function updateUserInterface() {
    const createAccountOption = document.getElementById('createAccountOption');
    const loginOption = document.getElementById('loginOption');
    const myAccountOption = document.getElementById('myAccountOption');
    const adminLink = document.getElementById('adminLink');
    const operatorLink = document.getElementById('operatorLink');
    const logoutOption = document.getElementById('logoutOption');
    
    if (window.currentUser) {
        if (createAccountOption) createAccountOption.style.display = 'none';
        if (loginOption) loginOption.style.display = 'none';
        if (myAccountOption) myAccountOption.style.display = 'flex';
        if (logoutOption) logoutOption.style.display = 'flex';
        
        if (window.isAdmin) {
            if (adminLink) adminLink.style.display = 'flex';
            if (operatorLink) operatorLink.style.display = 'none';
        } else if (window.isOperator) {
            if (adminLink) adminLink.style.display = 'none';
            if (operatorLink) operatorLink.style.display = 'flex';
        } else {
            if (adminLink) adminLink.style.display = 'none';
            if (operatorLink) operatorLink.style.display = 'none';
        }
    } else {
        if (createAccountOption) createAccountOption.style.display = 'flex';
        if (loginOption) loginOption.style.display = 'flex';
        if (myAccountOption) myAccountOption.style.display = 'none';
        if (adminLink) adminLink.style.display = 'none';
        if (operatorLink) operatorLink.style.display = 'none';
        if (logoutOption) logoutOption.style.display = 'none';
    }
}

// Gestion du compte utilisateur
function openAccountPanel() {
    if (!window.currentUser) {
        showNotification('Veuillez vous connecter pour accÃ©der Ã  votre compte', 'error');
        return;
    }
    
    const user = window.users.find(u => u.id === window.currentUser.id);
    if (user) {
        document.getElementById('accountName').value = user.name;
        document.getElementById('accountEmail').value = user.email;
        document.getElementById('accountPhone').value = user.phone || '';
        document.getElementById('accountAddress').value = user.address || '';
        
        document.getElementById('accountName').disabled = true;
        document.getElementById('accountEmail').disabled = true;
        document.getElementById('accountPhone').disabled = true;
        document.getElementById('accountAddress').disabled = true;
        
        document.getElementById('editAccountBtn').style.display = 'inline-flex';
        document.getElementById('saveAccountBtn').style.display = 'none';
        document.getElementById('cancelAccountBtn').style.display = 'none';
        
        displayUserOrders();
    }
    
    document.getElementById('accountPanel').style.display = 'block';
}

function closeAccountPanel() {
    document.getElementById('accountPanel').style.display = 'none';
}

function toggleEditAccount() {
    document.getElementById('accountPhone').disabled = false;
    document.getElementById('accountAddress').disabled = false;
    
    document.getElementById('editAccountBtn').style.display = 'none';
    document.getElementById('saveAccountBtn').style.display = 'inline-flex';
    document.getElementById('cancelAccountBtn').style.display = 'inline-flex';
}

function cancelEditAccount() {
    const user = window.users.find(u => u.id === window.currentUser.id);
    if (user) {
        document.getElementById('accountPhone').value = user.phone || '';
        document.getElementById('accountAddress').value = user.address || '';
    }
    
    document.getElementById('accountPhone').disabled = true;
    document.getElementById('accountAddress').disabled = true;
    
    document.getElementById('editAccountBtn').style.display = 'inline-flex';
    document.getElementById('saveAccountBtn').style.display = 'none';
    document.getElementById('cancelAccountBtn').style.display = 'none';
}

function saveAccountInfo() {
    const phone = document.getElementById('accountPhone').value;
    const address = document.getElementById('accountAddress').value;
    
    const userIndex = window.users.findIndex(u => u.id === window.currentUser.id);
    if (userIndex !== -1) {
        window.users[userIndex].phone = phone;
        window.users[userIndex].address = address;
        
        window.currentUser.phone = phone;
        window.currentUser.address = address;
        
        saveAllData();
        
        showNotification('Informations mises Ã  jour avec succÃ¨s !', 'success');
        
        document.getElementById('accountPhone').disabled = true;
        document.getElementById('accountAddress').disabled = true;
        
        document.getElementById('editAccountBtn').style.display = 'inline-flex';
        document.getElementById('saveAccountBtn').style.display = 'none';
        document.getElementById('cancelAccountBtn').style.display = 'none';
    }
}

function displayUserOrders() {
    const ordersList = document.getElementById('accountOrdersList');
    if (!ordersList) return;
    
    const userOrders = window.orders.filter(order => order.customerEmail === window.currentUser.email);
    
    if (userOrders.length === 0) {
        ordersList.innerHTML = '<p style="text-align: center; padding: 20px;">Aucune commande pour le moment</p>';
        return;
    }
    
    ordersList.innerHTML = '';
    
    userOrders.forEach(order => {
        const statusClass = getStatusClass(order.status);
        const statusText = getStatusText(order.status);
        
        const orderElement = document.createElement('div');
        orderElement.className = 'account-order';
        orderElement.style.cssText = `
            border: 1px solid var(--light-gray);
            border-radius: var(--radius-sm);
            padding: 15px;
            margin-bottom: 15px;
            background: var(--light);
        `;
        
        orderElement.innerHTML = `
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                <h4 style="margin: 0; color: var(--primary);">Commande #${order.id}</h4>
                <span style="font-weight: 600; color: var(--secondary);">${(order.total || 0).toFixed(2)} $</span>
            </div>
            <div style="margin-bottom: 10px;">
                <strong>Date:</strong> ${order.date || 'Date inconnue'}
            </div>
            <div style="margin-bottom: 10px;">
                <strong>Statut:</strong> <span class="status-badge ${statusClass}">${statusText}</span>
            </div>
            <div>
                <strong>Produits:</strong> ${order.items ? order.items.map(item => `${item.quantity || 0}x ${item.name || 'Produit'}`).join(', ') : 'Aucun produit'}
            </div>
        `;
        
        ordersList.appendChild(orderElement);
    });
}

function getStatusClass(status) {
    switch(status) {
        case ORDER_STATUS.PENDING: return 'status-pending';
        case ORDER_STATUS.PROCESSING: return 'status-processing';
        case ORDER_STATUS.SHIPPED: return 'status-shipped';
        case ORDER_STATUS.DELIVERED: return 'status-delivered';
        case ORDER_STATUS.CANCELLED: return 'status-cancelled';
        default: return 'status-pending';
    }
}

function getStatusText(status) {
    switch(status) {
        case ORDER_STATUS.PENDING: return 'En attente';
        case ORDER_STATUS.PROCESSING: return 'En cours';
        case ORDER_STATUS.SHIPPED: return 'ExpÃ©diÃ©e';
        case ORDER_STATUS.DELIVERED: return 'LivrÃ©e';
        case ORDER_STATUS.CANCELLED: return 'AnnulÃ©e';
        default: return 'Inconnu';
    }
}

function openAdminPanel() {
    if (!window.isAdmin) {
        showNotification('AccÃ¨s rÃ©servÃ© aux administrateurs', 'error');
        return;
    }
    
    document.getElementById('adminPanel').style.display = 'block';
    updateAdminStats();
    displayAdminProducts();
    displayAdminUsers();
    displayAdminOrders();
}

function closeAdminPanel() {
    document.getElementById('adminPanel').style.display = 'none';
}

function updateAdminStats() {
    document.getElementById('totalProducts').textContent = window.products.length;
    document.getElementById('totalOrders').textContent = window.orders.length;
    document.getElementById('totalUsers').textContent = window.users.length;
    
    const totalRevenue = window.orders.reduce((sum, order) => sum + (order.total || 0), 0);
    document.getElementById('totalRevenue').textContent = totalRevenue.toFixed(2) + ' $';
}

function displayAdminProducts() {
    const productsList = document.getElementById('adminProductsList');
    if (!productsList) return;
    
    productsList.innerHTML = '';
    
    window.products.forEach(product => {
        const row = document.createElement('tr');
        row.innerHTML = `
            <td>${product.id}</td>
            <td><img src="${product.image || 'https://via.placeholder.com/50x50?text=Image'}" alt="${product.name}" style="width: 50px; height: 50px; object-fit: contain;"></td>
            <td>${product.name}</td>
            <td>${(product.price || 0).toFixed(2)} $</td>
            <td>
                <button class="admin-btn secondary" onclick="editProduct(${product.id})">
                    <i class="fas fa-edit"></i> Modifier
                </button>
                <button class="admin-btn danger" onclick="deleteProduct(${product.id})">
                    <i class="fas fa-trash"></i> Supprimer
                </button>
            </td>
        `;
        productsList.appendChild(row);
    });
}

function displayAdminUsers() {
    const usersList = document.getElementById('adminUsersList');
    if (!usersList) return;
    
    usersList.innerHTML = '';
    
    window.users.forEach(user => {
        const statusClass = user.status === 'approved' ? 'status-approved' : 
                           user.status === 'rejected' ? 'status-rejected' : 'status-pending';
        
        const row = document.createElement('tr');
        row.innerHTML = `
            <td>${user.id}</td>
            <td>${user.name}</td>
            <td>${user.email}</td>
            <td>${user.phone || 'Non renseignÃ©'}</td>
            <td>
                <span class="status-badge ${statusClass}">${user.status === 'approved' ? 'ApprouvÃ©' : user.status === 'rejected' ? 'RejetÃ©' : 'En attente'}</span>
            </td>
            <td>
                ${user.permissions ? user.permissions.map(perm => {
                    const permission = availablePermissions.find(p => p.id === perm);
                    return permission ? `<span class="permission-badge">${permission.name}</span>` : '';
                }).join('') : 'Aucune'}
            </td>
            <td>
                <div style="display: flex; gap: 5px; flex-wrap: wrap;">
                    ${user.status === 'pending' ? `
                        <button class="admin-btn success" onclick="approveUser(${user.id})" title="Approuver l'utilisateur">
                            <i class="fas fa-check"></i>
                        </button>
                        <button class="admin-btn danger" onclick="rejectUser(${user.id})" title="Rejeter l'utilisateur">
                            <i class="fas fa-times"></i>
                        </button>
                    ` : ''}
                    <button class="admin-btn secondary" onclick="editUserPermissions(${user.id})" title="Modifier les permissions">
                        <i class="fas fa-key"></i>
                    </button>
                    ${!user.isAdmin && !user.isOperator && user.email !== ADMIN_CREDENTIALS.email && user.email !== OPERATOR_CREDENTIALS.email ? `
                        <button class="admin-btn danger" onclick="deleteUser(${user.id})" title="Supprimer l'utilisateur">
                            <i class="fas fa-trash"></i>
                        </button>
                    ` : ''}
                </div>
            </td>
        `;
        usersList.appendChild(row);
    });
}

function displayAdminOrders() {
    const ordersList = document.getElementById('adminOrdersList');
    if (!ordersList) return;
    
    ordersList.innerHTML = '';
    
    if (window.orders.length === 0) {
        ordersList.innerHTML = `
            <tr>
                <td colspan="7" style="text-align: center; padding: 20px;">
                    Aucune commande pour le moment
                </td>
            </tr>
        `;
        return;
    }
    
    window.orders.forEach(order => {
        const statusClass = getStatusClass(order.status);
        const statusText = getStatusText(order.status);
        
        const row = document.createElement('tr');
        row.innerHTML = `
            <td>#${order.id}</td>
            <td>${order.customerName || 'Non spÃ©cifiÃ©'}<br><small>${order.customerEmail || ''}</small></td>
            <td>${order.items ? order.items.map(item => `${item.quantity || 0}x ${item.name || 'Produit'}`).join(', ') : 'Aucun produit'}</td>
            <td>${(order.total || 0).toFixed(2)} $</td>
            <td>${order.date || 'Date inconnue'}</td>
            <td><span class="status-badge ${statusClass}">${statusText}</span></td>
            <td>
                <div class="order-actions">
                    <button class="admin-btn info" onclick="changeOrderStatus(${order.id}, 'processing')" title="Marquer comme en cours">
                        <i class="fas fa-cog"></i>
                    </button>
                    <button class="admin-btn success" onclick="changeOrderStatus(${order.id}, 'shipped')" title="Marquer comme expÃ©diÃ©e">
                        <i class="fas fa-shipping-fast"></i>
                    </button>
                    <button class="admin-btn secondary" onclick="changeOrderStatus(${order.id}, 'delivered')" title="Marquer comme livrÃ©e">
                        <i class="fas fa-check-circle"></i>
                    </button>
                    <button class="admin-btn danger" onclick="changeOrderStatus(${order.id}, 'cancelled')" title="Annuler la commande">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            </td>
        `;
        ordersList.appendChild(row);
    });
}

// FONCTIONS ADMIN SUPPLÃMENTAIRES
function showAddProductForm() {
    document.getElementById('addProductForm').style.display = 'block';
}

function hideAddProductForm() {
    document.getElementById('addProductForm').style.display = 'none';
    document.getElementById('productForm').reset();
}

function addNewProduct() {
    const name = document.getElementById('productName').value;
    const price = parseFloat(document.getElementById('productPrice').value);
    const image = document.getElementById('productImage').value;
    const description = document.getElementById('productDescription').value;
    
    if (name && price && image && description) {
        const newProduct = {
            id: window.products.length > 0 ? Math.max(...window.products.map(p => p.id || 0)) + 1 : 10,
            name: name,
            price: price,
            image: image,
            description: description,
            features: ["Nouveau produit", "Haute qualitÃ©"],
            usage: "Mode d'utilisation Ã  dÃ©finir"
        };
        
        window.products.push(newProduct);
        saveAllData();
        
        showNotification('Produit ajoutÃ© avec succÃ¨s !', 'success');
        hideAddProductForm();
        displayAdminProducts();
        displayProducts();
    } else {
        showNotification('Veuillez remplir tous les champs', 'error');
    }
}

function editUserPermissions(userId) {
    const user = window.users.find(u => u.id === userId);
    if (!user) return;

    const modalContent = document.createElement('div');
    modalContent.className = 'modal-content';
    modalContent.innerHTML = `
        <div class="modal-header">
            <h2><i class="fas fa-key"></i> Gestion des Permissions - ${user.name}</h2>
            <button class="close-modal" onclick="closeCustomAlert()">&times;</button>
        </div>
        
        <div class="form-group">
            <label><strong>Permissions actuelles :</strong></label>
            <div id="currentPermissions" style="margin: 10px 0; padding: 10px; background: var(--light); border-radius: var(--radius-sm);">
                ${user.permissions && user.permissions.length > 0 ? 
                    user.permissions.map(perm => {
                        const permission = availablePermissions.find(p => p.id === perm);
                        return permission ? `<span class="permission-badge">${permission.name}</span>` : '';
                    }).join('') : 
                    '<span style="color: var(--dark-gray);">Aucune permission</span>'
                }
            </div>
        </div>
        
        <div class="form-group">
            <label><strong>Modifier les permissions :</strong></label>
            <div style="max-height: 200px; overflow-y: auto; border: 1px solid var(--light-gray); border-radius: var(--radius-sm); padding: 10px;">
                ${availablePermissions.map(perm => `
                    <div style="margin-bottom: 8px;">
                        <label style="display: flex; align-items: center; cursor: pointer;">
                            <input type="checkbox" 
                                   value="${perm.id}" 
                                   ${user.permissions && user.permissions.includes(perm.id) ? 'checked' : ''}
                                   style="margin-right: 8px;">
                            ${perm.name}
                        </label>
                    </div>
                `).join('')}
            </div>
        </div>
        
        <div style="display: flex; gap: 10px; margin-top: 20px;">
            <button class="admin-btn primary" onclick="saveUserPermissions(${userId})">
                <i class="fas fa-save"></i> Enregistrer
            </button>
            <button class="admin-btn secondary" onclick="closeCustomAlert()">
                <i class="fas fa-times"></i> Annuler
            </button>
        </div>
    `;
    
    showCustomAlert(modalContent);
}

function saveUserPermissions(userId) {
    const checkboxes = document.querySelectorAll('#customAlert input[type="checkbox"]');
    const selectedPermissions = [];
    
    checkboxes.forEach(checkbox => {
        if (checkbox.checked) {
            selectedPermissions.push(checkbox.value);
        }
    });
    
    const userIndex = window.users.findIndex(u => u.id === userId);
    if (userIndex !== -1) {
        window.users[userIndex].permissions = selectedPermissions;
        saveAllData();
        
        // Mettre Ã  jour l'interface utilisateur si l'utilisateur modifiÃ© est l'utilisateur courant
        if (window.currentUser && window.currentUser.id === userId) {
            window.currentUser.permissions = selectedPermissions;
            window.isAdmin = selectedPermissions.includes('manage_users');
            window.isOperator = selectedPermissions.includes('operator_orders');
            updateUserInterface();
        }
        
        showNotification('Permissions mises Ã  jour avec succÃ¨s', 'success');
        closeCustomAlert();
        displayAdminUsers(); // RafraÃ®chir la liste des utilisateurs
    }
}

function editProduct(productId) {
    const product = window.products.find(p => p.id === productId);
    if (!product) return;

    const modalContent = document.createElement('div');
    modalContent.className = 'modal-content';
    modalContent.innerHTML = `
        <div class="modal-header">
            <h2><i class="fas fa-edit"></i> Modifier le produit</h2>
            <button class="close-modal" onclick="closeCustomAlert()">&times;</button>
        </div>
        
        <form id="editProductForm">
            <div class="form-group">
                <label for="editProductName">Nom du produit</label>
                <input type="text" id="editProductName" value="${product.name || ''}" required>
            </div>
            <div class="form-group">
                <label for="editProductPrice">Prix ($)</label>
                <input type="number" id="editProductPrice" step="0.01" value="${product.price || 0}" required>
            </div>
            <div class="form-group">
                <label for="editProductImage">URL de l'image</label>
                <input type="url" id="editProductImage" value="${product.image || ''}" required>
            </div>
            <div class="form-group">
                <label for="editProductDescription">Description</label>
                <textarea id="editProductDescription" rows="3" required>${product.description || ''}</textarea>
            </div>
            <div class="form-group">
                <label for="editProductFeatures">CaractÃ©ristiques (une par ligne)</label>
                <textarea id="editProductFeatures" rows="3">${product.features ? product.features.join('\n') : ''}</textarea>
            </div>
            <div class="form-group">
                <label for="editProductUsage">Mode d'utilisation</label>
                <textarea id="editProductUsage" rows="2">${product.usage || ''}</textarea>
            </div>
            
            <div style="display: flex; gap: 10px; margin-top: 20px;">
                <button type="submit" class="admin-btn primary">
                    <i class="fas fa-save"></i> Enregistrer
                </button>
                <button type="button" class="admin-btn secondary" onclick="closeCustomAlert()">
                    <i class="fas fa-times"></i> Annuler
                </button>
                <button type="button" class="admin-btn danger" onclick="deleteProduct(${productId})" style="margin-left: auto;">
                    <i class="fas fa-trash"></i> Supprimer
                </button>
            </div>
        </form>
    `;
    
    showCustomAlert(modalContent);
    
    // Ajouter l'Ã©vÃ©nement pour le formulaire
    setTimeout(() => {
        const form = document.getElementById('editProductForm');
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault();
                saveProductChanges(productId);
            });
        }
    }, 100);
}

function saveProductChanges(productId) {
    const name = document.getElementById('editProductName').value;
    const price = parseFloat(document.getElementById('editProductPrice').value);
    const image = document.getElementById('editProductImage').value;
    const description = document.getElementById('editProductDescription').value;
    const featuresText = document.getElementById('editProductFeatures').value;
    const usage = document.getElementById('editProductUsage').value;
    
    const features = featuresText.split('\n').filter(line => line.trim() !== '');
    
    if (name && price && image && description) {
        const productIndex = window.products.findIndex(p => p.id === productId);
        if (productIndex !== -1) {
            window.products[productIndex] = {
                ...window.products[productIndex],
                name: name,
                price: price,
                image: image,
                description: description,
                features: features.length > 0 ? features : ["Produit de qualitÃ©", "FabriquÃ© avec soin"],
                usage: usage || "Mode d'utilisation Ã  dÃ©finir"
            };
            
            saveAllData();
            showNotification('Produit modifiÃ© avec succÃ¨s !', 'success');
            closeCustomAlert();
            displayAdminProducts();
            displayProducts(); // RafraÃ®chir l'affichage des produits
        }
    } else {
        showNotification('Veuillez remplir tous les champs obligatoires', 'error');
    }
}

function deleteProduct(productId) {
    if (!confirm('Ãtes-vous sÃ»r de vouloir supprimer ce produit ? Cette action est irrÃ©versible.')) {
        return;
    }
    
    const productIndex = window.products.findIndex(p => p.id === productId);
    if (productIndex !== -1) {
        // VÃ©rifier si le produit est dans des commandes
        const productInOrders = window.orders.some(order => 
            order.items && order.items.some(item => item.id === productId)
        );
        
        if (productInOrders) {
            showNotification('Ce produit ne peut pas Ãªtre supprimÃ© car il est prÃ©sent dans des commandes.', 'error');
            return;
        }
        
        window.products.splice(productIndex, 1);
        saveAllData();
        showNotification('Produit supprimÃ© avec succÃ¨s', 'success');
        
        // Fermer les modales si ouvertes
        closeCustomAlert();
        hideAddProductForm();
        
        // RafraÃ®chir les affichages
        displayAdminProducts();
        displayProducts();
    }
}

function deleteUser(userId) {
    const user = window.users.find(u => u.id === userId);
    if (!user) return;
    
    // EmpÃªcher la suppression des comptes systÃ¨me
    if (user.isAdmin || user.isOperator || user.email === ADMIN_CREDENTIALS.email || user.email === OPERATOR_CREDENTIALS.email) {
        showNotification('Impossible de supprimer les comptes systÃ¨me', 'error');
        return;
    }
    
    // VÃ©rifier si l'utilisateur a des commandes
    const userOrders = window.orders.filter(order => order.customerEmail === user.email);
    if (userOrders.length > 0) {
        showNotification('Impossible de supprimer cet utilisateur car il a des commandes associÃ©es.', 'error');
        return;
    }
    
    if (!confirm(`Ãtes-vous sÃ»r de vouloir supprimer l'utilisateur "${user.name}" ? Cette action est irrÃ©versible.`)) {
        return;
    }
    
    const userIndex = window.users.findIndex(u => u.id === userId);
    if (userIndex !== -1) {
        window.users.splice(userIndex, 1);
        saveAllData();
        showNotification('Utilisateur supprimÃ© avec succÃ¨s', 'success');
        displayAdminUsers();
    }
}

function approveUser(userId) {
    const userIndex = window.users.findIndex(u => u.id === userId);
    if (userIndex !== -1) {
        window.users[userIndex].status = 'approved';
        window.users[userIndex].permissions = ['view_products', 'purchase', 'manage_own_orders'];
        saveAllData();
        displayAdminUsers();
        showNotification('Utilisateur approuvÃ© avec succÃ¨s', 'success');
    }
}

function rejectUser(userId) {
    const userIndex = window.users.findIndex(u => u.id === userId);
    if (userIndex !== -1) {
        window.users[userIndex].status = 'rejected';
        saveAllData();
        displayAdminUsers();
        showNotification('Utilisateur rejetÃ©', 'info');
    }
}

function changeOrderStatus(orderId, newStatus) {
    const orderIndex = window.orders.findIndex(o => o.id === orderId);
    if (orderIndex !== -1) {
        const oldStatus = window.orders[orderIndex].status;
        window.orders[orderIndex].status = newStatus;
        
        if (!window.orders[orderIndex].statusHistory) {
            window.orders[orderIndex].statusHistory = [];
        }
        window.orders[orderIndex].statusHistory.push({
            status: newStatus,
            date: new Date().toISOString(),
            changedBy: window.currentUser ? window.currentUser.name : 'SystÃ¨me'
        });
        
        saveAllData();
        
        if (document.getElementById('adminPanel').style.display === 'block') {
            displayAdminOrders();
        }
        
        showNotification(`Statut de la commande #${orderId} changÃ© de "${getStatusText(oldStatus)}" Ã  "${getStatusText(newStatus)}"`, 'success');
    }
}

// =============================================
// ÃDITEUR "Ã PROPOS" AMÃLIORÃ
// =============================================

function showEditAboutForm() {
    const modalContent = document.createElement('div');
    modalContent.className = 'modal-content content-editor';
    modalContent.innerHTML = `
        <div class="modal-header">
            <h2><i class="fas fa-edit"></i> Ãditeur de la page "Ã propos"</h2>
            <button class="close-modal" onclick="closeCustomAlert()">&times;</button>
        </div>
        
        <div class="editor-tabs">
            <button class="editor-tab active" onclick="switchEditorTab('about', 'content')">
                <i class="fas fa-edit"></i> Contenu principal
            </button>
            <button class="editor-tab" onclick="switchEditorTab('about', 'sections')">
                <i class="fas fa-th-large"></i> Sections modulaires
            </button>
            <button class="editor-tab" onclick="switchEditorTab('about', 'features')">
                <i class="fas fa-star"></i> FonctionnalitÃ©s
            </button>
            <button class="editor-tab" onclick="switchEditorTab('about', 'preview')">
                <i class="fas fa-eye"></i> AperÃ§u
            </button>
        </div>
        
        <form id="editAboutForm">
            <!-- PANEL CONTENU PRINCIPAL -->
            <div class="editor-panel active" id="about-content-panel">
                <div class="editor-section">
                    <div class="editor-section-header">
                        <h4><i class="fas fa-heading"></i> En-tÃªte de la page</h4>
                    </div>
                    <div class="grid-editor">
                        <div class="editor-field">
                            <label for="aboutTitle">Titre principal</label>
                            <input type="text" id="aboutTitle" value="${window.pageContent.about.title || defaultPageContent.about.title}" 
                                   oninput="updateAboutPreview()" placeholder="Notre Histoire & Engagement">
                        </div>
                        <div class="editor-field">
                            <label for="aboutSubtitle">Sous-titre</label>
                            <input type="text" id="aboutSubtitle" value="${window.pageContent.about.subtitle || defaultPageContent.about.subtitle}" 
                                   oninput="updateAboutPreview()" placeholder="DÃ©couvrez notre passion pour le bien-Ãªtre naturel">
                        </div>
                    </div>
                </div>

                <div class="editor-section">
                    <div class="editor-section-header">
                        <h4><i class="fas fa-image"></i> Image principale</h4>
                    </div>
                    <div class="editor-field">
                        <label>Image d'en-tÃªte</label>
                        <div class="image-upload" onclick="document.getElementById('aboutImageUpload').click()" 
                             ondragover="handleDragOver(event)" ondrop="handleImageDrop(event, 'about')">
                            <div class="upload-placeholder">
                                <i class="fas fa-cloud-upload-alt"></i>
                                <p>Cliquez pour sÃ©lectionner ou glissez-dÃ©posez une image</p>
                                <small>Format recommandÃ© : 1200x600px</small>
                            </div>
                            <div class="image-preview" id="aboutImagePreview">
                                <img src="" alt="AperÃ§u">
                            </div>
                        </div>
                        <input type="file" id="aboutImageUpload" accept="image/*" style="display: none" 
                               onchange="handleImageUpload(this, 'about')">
                        <input type="hidden" id="aboutImageUrl" value="${window.pageContent.about.image || ''}">
                    </div>
                </div>

                <div class="editor-section">
                    <div class="editor-section-header">
                        <h4><i class="fas fa-align-left"></i> Contenu principal</h4>
                    </div>
                    <div class="editor-field">
                        <label>Description dÃ©taillÃ©e</label>
                        <div class="wysiwyg-toolbar">
                            <div class="wysiwyg-group">
                                <button type="button" class="wysiwyg-btn" onclick="formatText('bold', 'about')" title="Gras">
                                    <i class="fas fa-bold"></i>
                                </button>
                                <button type="button" class="wysiwyg-btn" onclick="formatText('italic', 'about')" title="Italique">
                                    <i class="fas fa-italic"></i>
                                </button>
                                <button type="button" class="wysiwyg-btn" onclick="formatText('underline', 'about')" title="SoulignÃ©">
                                    <i class="fas fa-underline"></i>
                                </button>
                            </div>
                            <div class="wysiwyg-group">
                                <button type="button" class="wysiwyg-btn" onclick="formatText('justifyLeft', 'about')" title="Aligner Ã  gauche">
                                    <i class="fas fa-align-left"></i>
                                </button>
                                <button type="button" class="wysiwyg-btn" onclick="formatText('justifyCenter', 'about')" title="Centrer">
                                    <i class="fas fa-align-center"></i>
                                </button>
                                <button type="button" class="wysiwyg-btn" onclick="formatText('justifyRight', 'about')" title="Aligner Ã  droite">
                                    <i class="fas fa-align-right"></i>
                                </button>
                            </div>
                            <div class="wysiwyg-group">
                                <button type="button" class="wysiwyg-btn" onclick="formatText('insertUnorderedList', 'about')" title="Liste Ã  puces">
                                    <i class="fas fa-list-ul"></i>
                                </button>
                                <button type="button" class="wysiwyg-btn" onclick="formatText('insertOrderedList', 'about')" title="Liste numÃ©rotÃ©e">
                                    <i class="fas fa-list-ol"></i>
                                </button>
                            </div>
                            <div class="wysiwyg-group">
                                <button type="button" class="wysiwyg-btn" onclick="insertLink('about')" title="Lien">
                                    <i class="fas fa-link"></i>
                                </button>
                                <button type="button" class="wysiwyg-btn" onclick="insertImageEditor('about')" title="Image">
                                    <i class="fas fa-image"></i>
                                </button>
                            </div>
                            <div class="wysiwyg-group">
                                <button type="button" class="wysiwyg-btn" onclick="formatText('formatBlock', 'about', '<h2>')" title="Titre 2">
                                    H2
                                </button>
                                <button type="button" class="wysiwyg-btn" onclick="formatText('formatBlock', 'about', '<h3>')" title="Titre 3">
                                    H3
                                </button>
                                <button type="button" class="wysiwyg-btn" onclick="formatText('formatBlock', 'about', '<p>')" title="Paragraphe">
                                    P
                                </button>
                            </div>
                        </div>
                        <div id="aboutContentEditor" class="wysiwyg-editor" contenteditable="true">
                            ${window.pageContent.about.content || defaultPageContent.about.content}
                        </div>
                    </div>
                </div>
            </div>

            <!-- PANEL SECTIONS MODULAIRES -->
            <div class="editor-panel" id="about-sections-panel">
                <div class="editor-section">
                    <div class="editor-section-header">
                        <h4><i class="fas fa-layer-group"></i> Sections personnalisÃ©es</h4>
                        <button type="button" class="admin-btn primary" onclick="addAboutSection()">
                            <i class="fas fa-plus"></i> Ajouter une section
                        </button>
                    </div>
                    
                    <div id="aboutSectionsContainer">
                        ${renderAboutSections()}
                    </div>
                </div>
            </div>

            <!-- PANEL FONCTIONNALITÃS -->
            <div class="editor-panel" id="about-features-panel">
                <div class="editor-section">
                    <div class="editor-section-header">
                        <h4><i class="fas fa-star"></i> FonctionnalitÃ©s principales</h4>
                        <button type="button" class="admin-btn primary" onclick="addAboutFeature()">
                            <i class="fas fa-plus"></i> Ajouter une fonctionnalitÃ©
                        </button>
                    </div>
                    
                    <div id="aboutFeaturesContainer">
                        ${renderAboutFeatures()}
                    </div>
                </div>
            </div>

            <!-- PANEL APERÃU -->
            <div class="editor-panel" id="about-preview-panel">
                <div class="editor-section">
                    <div class="editor-section-header">
                        <h4><i class="fas fa-eye"></i> AperÃ§u en temps rÃ©el</h4>
                        <button type="button" class="admin-btn secondary" onclick="updateAboutPreview()">
                            <i class="fas fa-sync-alt"></i> Actualiser
                        </button>
                    </div>
                    
                    <div class="content-preview">
                        <div id="aboutPreviewContent">
                            ${generateAboutPreview()}
                        </div>
                    </div>
                </div>
            </div>

            <div class="editor-actions">
                <div class="save-status" id="aboutSaveStatus">
                    <i class="fas fa-check-circle"></i> SauvegardÃ©
                </div>
                <div class="action-group">
                    <button type="button" class="admin-btn warning" onclick="resetAboutContent()">
                        <i class="fas fa-undo"></i> Restaurer les valeurs par dÃ©faut
                    </button>
                    <button type="button" class="admin-btn secondary" onclick="closeCustomAlert()">
                        <i class="fas fa-times"></i> Annuler
                    </button>
                    <button type="button" class="admin-btn primary" onclick="saveAboutContent()">
                        <i class="fas fa-save"></i> Sauvegarder
                    </button>
                </div>
            </div>
        </form>
    `;
    
    showCustomAlert(modalContent);
    
    // Initialiser l'Ã©diteur
    setTimeout(() => {
        initializeAboutEditor();
        updateAboutPreview();
        startAutoSave('about');
    }, 100);
}

// FONCTIONS POUR L'ÃDITEUR AMÃLIORÃ
function initializeAboutEditor() {
    // Initialiser l'image si elle existe
    const imageUrl = window.pageContent.about.image || '';
    if (imageUrl) {
        document.getElementById('aboutImagePreview').style.display = 'block';
        document.getElementById('aboutImagePreview').querySelector('img').src = imageUrl;
        document.getElementById('aboutImageUrl').value = imageUrl;
    }
}

function handleDragOver(event) {
    event.preventDefault();
    event.currentTarget.classList.add('dragover');
}

function handleImageDrop(event, type) {
    event.preventDefault();
    event.currentTarget.classList.remove('dragover');
    
    const files = event.dataTransfer.files;
    if (files.length > 0) {
        handleImageFile(files[0], type);
    }
}

function handleImageUpload(input, type) {
    if (input.files.length > 0) {
        handleImageFile(input.files[0], type);
    }
}

function handleImageFile(file, type) {
    if (!file.type.startsWith('image/')) {
        showNotification('Veuillez sÃ©lectionner un fichier image valide', 'error');
        return;
    }
    
    // Dans une vraie application, vous uploaderiez le fichier sur un serveur
    // Pour cette dÃ©mo, nous utilisons une URL de donnÃ©es
    const reader = new FileReader();
    reader.onload = function(e) {
        const imageUrl = e.target.result;
        document.getElementById(`${type}ImagePreview`).style.display = 'block';
        document.getElementById(`${type}ImagePreview`).querySelector('img').src = imageUrl;
        document.getElementById(`${type}ImageUrl`).value = imageUrl;
        updateAboutPreview();
        showNotification('Image ajoutÃ©e avec succÃ¨s', 'success');
    };
    reader.readAsDataURL(file);
}

function insertLink(type) {
    const url = prompt('Entrez l\'URL du lien:', 'https://');
    if (url) {
        const text = prompt('Entrez le texte du lien:', 'Lien');
        if (text) {
            const editor = document.getElementById(`${type}ContentEditor`);
            const link = `<a href="${url}" target="_blank">${text}</a>`;
            document.execCommand('insertHTML', false, link);
            editor.focus();
        }
    }
}

function insertImageEditor(type) {
    const url = prompt("Entrez l'URL de l'image:", 'https://');
    if (url) {
        const editor = document.getElementById(`${type}ContentEditor`);
        const img = `<img src="${url}" alt="Image" style="max-width: 100%; height: auto; border-radius: 8px; margin: 10px 0;">`;
        document.execCommand('insertHTML', false, img);
        editor.focus();
    }
}

function switchEditorTab(page, tab) {
    // DÃ©sactiver tous les onglets et panneaux
    const tabs = document.querySelectorAll(`#edit${page.charAt(0).toUpperCase() + page.slice(1)}Form .editor-tab`);
    const panels = document.querySelectorAll(`#edit${page.charAt(0).toUpperCase() + page.slice(1)}Form .editor-panel`);
    
    tabs.forEach(t => t.classList.remove('active'));
    panels.forEach(p => p.classList.remove('active'));
    
    // Activer l'onglet et le panneau sÃ©lectionnÃ©s
    const activeTab = document.querySelector(`#edit${page.charAt(0).toUpperCase() + page.slice(1)}Form .editor-tab:nth-child(${tab === 'content' ? 1 : tab === 'sections' ? 2 : tab === 'features' ? 3 : 4})`);
    const activePanel = document.getElementById(`${page}-${tab}-panel`);
    
    if (activeTab) activeTab.classList.add('active');
    if (activePanel) activePanel.classList.add('active');
    
    // Mettre Ã  jour l'aperÃ§u si nÃ©cessaire
    if (tab === 'preview') {
        if (page === 'about') {
            updateAboutPreview();
        }
    }
}

function formatText(command, type, value = null) {
    const editor = document.getElementById(`${type}ContentEditor`);
    if (editor) {
        if (value) {
            document.execCommand(command, false, value);
        } else {
            document.execCommand(command, false, null);
        }
        editor.focus();
        
        // Mettre Ã  jour l'aperÃ§u si on est sur l'onglet aperÃ§u
        if (type === 'about') {
            updateAboutPreview();
        }
    }
}

// FONCTIONS POUR LES SECTIONS MODULAIRES
function renderAboutSections() {
    if (!window.pageContent.about.sections) {
        window.pageContent.about.sections = defaultPageContent.about.sections || [];
    }
    
    return window.pageContent.about.sections.map(section => `
        <div class="editor-section" data-section-id="${section.id}">
            <div class="editor-section-header">
                <h4>${section.title || 'Nouvelle Section'}</h4>
                <div class="section-controls">
                    <button type="button" class="admin-btn secondary" onclick="moveSectionUp(${section.id})">
                        <i class="fas fa-arrow-up"></i>
                    </button>
                    <button type="button" class="admin-btn secondary" onclick="moveSectionDown(${section.id})">
                        <i class="fas fa-arrow-down"></i>
                    </button>
                    <button type="button" class="admin-btn danger" onclick="removeAboutSection(${section.id})">
                        <i class="fas fa-trash"></i>
                    </button>
                </div>
            </div>
            <div class="grid-editor">
                <div class="editor-field">
                    <label>Titre de la section</label>
                    <input type="text" value="${section.title || ''}" 
                           oninput="updateAboutSection(${section.id}, 'title', this.value)">
                </div>
                <div class="editor-field">
                    <label>Position de l'image</label>
                    <select onchange="updateAboutSection(${section.id}, 'position', this.value)">
                        <option value="left" ${section.position === 'left' ? 'selected' : ''}>Image Ã  gauche</option>
                        <option value="right" ${section.position === 'right' ? 'selected' : ''}>Image Ã  droite</option>
                        <option value="none" ${section.position === 'none' ? 'selected' : ''}>Pas d'image</option>
                    </select>
                </div>
            </div>
            <div class="editor-field">
                <label>Contenu de la section</label>
                <textarea oninput="updateAboutSection(${section.id}, 'content', this.value)" 
                          rows="4">${section.content || ''}</textarea>
            </div>
            ${section.position !== 'none' ? `
            <div class="editor-field">
                <label>Image de la section</label>
                <input type="text" value="${section.image || ''}" 
                       oninput="updateAboutSection(${section.id}, 'image', this.value)" 
                       placeholder="URL de l'image">
            </div>
            ` : ''}
        </div>
    `).join('');
}

function addAboutSection() {
    const newSection = {
        id: Date.now(),
        title: 'Nouvelle Section',
        content: 'Contenu de la section...',
        image: '',
        position: 'left'
    };
    
    if (!window.pageContent.about.sections) {
        window.pageContent.about.sections = [];
    }
    
    window.pageContent.about.sections.push(newSection);
    document.getElementById('aboutSectionsContainer').innerHTML = renderAboutSections();
    updateAboutPreview();
}

function removeAboutSection(sectionId) {
    if (confirm('Ãtes-vous sÃ»r de vouloir supprimer cette section ?')) {
        window.pageContent.about.sections = window.pageContent.about.sections.filter(s => s.id !== sectionId);
        document.getElementById('aboutSectionsContainer').innerHTML = renderAboutSections();
        updateAboutPreview();
    }
}

function updateAboutSection(sectionId, field, value) {
    const section = window.pageContent.about.sections.find(s => s.id === sectionId);
    if (section) {
        section[field] = value;
        updateAboutPreview();
    }
}

function moveSectionUp(sectionId) {
    const sections = window.pageContent.about.sections;
    const index = sections.findIndex(s => s.id === sectionId);
    if (index > 0) {
        [sections[index], sections[index - 1]] = [sections[index - 1], sections[index]];
        document.getElementById('aboutSectionsContainer').innerHTML = renderAboutSections();
        updateAboutPreview();
    }
}

function moveSectionDown(sectionId) {
    const sections = window.pageContent.about.sections;
    const index = sections.findIndex(s => s.id === sectionId);
    if (index < sections.length - 1) {
        [sections[index], sections[index + 1]] = [sections[index + 1], sections[index]];
        document.getElementById('aboutSectionsContainer').innerHTML = renderAboutSections();
        updateAboutPreview();
    }
}

// FONCTIONS POUR LES FONCTIONNALITÃS
function renderAboutFeatures() {
    if (!window.pageContent.about.features) {
        window.pageContent.about.features = defaultPageContent.about.features || [];
    }
    
    return window.pageContent.about.features.map(feature => `
        <div class="feature-editor" data-feature-id="${feature.id}">
            <div class="feature-header">
                <div class="feature-title">${feature.title}</div>
                <div class="feature-controls">
                    <button type="button" class="admin-btn secondary" onclick="moveFeatureUp(${feature.id})">
                        <i class="fas fa-arrow-up"></i>
                    </button>
                    <button type="button" class="admin-btn secondary" onclick="moveFeatureDown(${feature.id})">
                        <i class="fas fa-arrow-down"></i>
                    </button>
                    <button type="button" class="admin-btn danger" onclick="removeAboutFeature(${feature.id})">
                        <i class="fas fa-trash"></i>
                    </button>
                </div>
            </div>
            <div class="grid-editor">
                <div class="editor-field">
                    <label>IcÃ´ne (classe FontAwesome)</label>
                    <input type="text" value="${feature.icon || ''}" 
                           oninput="updateAboutFeature(${feature.id}, 'icon', this.value)" 
                           placeholder="fas fa-icon">
                </div>
                <div class="editor-field">
                    <label>Titre</label>
                    <input type="text" value="${feature.title || ''}" 
                           oninput="updateAboutFeature(${feature.id}, 'title', this.value)">
                </div>
            </div>
            <div class="editor-field">
                <label>Description</label>
                <textarea oninput="updateAboutFeature(${feature.id}, 'description', this.value)" 
                          rows="3">${feature.description || ''}</textarea>
            </div>
        </div>
    `).join('');
}

function addAboutFeature() {
    const newFeature = {
        id: Date.now(),
        icon: 'fas fa-star',
        title: 'Nouvelle FonctionnalitÃ©',
        description: 'Description de la fonctionnalitÃ©...'
    };
    
    if (!window.pageContent.about.features) {
        window.pageContent.about.features = [];
    }
    
    window.pageContent.about.features.push(newFeature);
    document.getElementById('aboutFeaturesContainer').innerHTML = renderAboutFeatures();
    updateAboutPreview();
}

function removeAboutFeature(featureId) {
    if (confirm('Ãtes-vous sÃ»r de vouloir supprimer cette fonctionnalitÃ© ?')) {
        window.pageContent.about.features = window.pageContent.about.features.filter(f => f.id !== featureId);
        document.getElementById('aboutFeaturesContainer').innerHTML = renderAboutFeatures();
        updateAboutPreview();
    }
}

function updateAboutFeature(featureId, field, value) {
    const feature = window.pageContent.about.features.find(f => f.id === featureId);
    if (feature) {
        feature[field] = value;
        updateAboutPreview();
    }
}

function moveFeatureUp(featureId) {
    const features = window.pageContent.about.features;
    const index = features.findIndex(f => f.id === featureId);
    if (index > 0) {
        [features[index], features[index - 1]] = [features[index - 1], features[index]];
        document.getElementById('aboutFeaturesContainer').innerHTML = renderAboutFeatures();
        updateAboutPreview();
    }
}

function moveFeatureDown(featureId) {
    const features = window.pageContent.about.features;
    const index = features.findIndex(f => f.id === featureId);
    if (index < features.length - 1) {
        [features[index], features[index + 1]] = [features[index + 1], features[index]];
        document.getElementById('aboutFeaturesContainer').innerHTML = renderAboutFeatures();
        updateAboutPreview();
    }
}

// FONCTION DE PRÃVISUALISATION AMÃLIORÃE
function generateAboutPreview() {
    const title = document.getElementById('aboutTitle')?.value || window.pageContent.about.title || defaultPageContent.about.title;
    const subtitle = document.getElementById('aboutSubtitle')?.value || window.pageContent.about.subtitle || defaultPageContent.about.subtitle;
    const content = document.getElementById('aboutContentEditor')?.innerHTML || window.pageContent.about.content || defaultPageContent.about.content;
    const image = document.getElementById('aboutImageUrl')?.value || window.pageContent.about.image || '';
    
    let previewHTML = `
        <div class="preview-header">
            <h1 class="preview-title">${title}</h1>
            <p class="preview-subtitle">${subtitle}</p>
            ${image ? `<img src="${image}" alt="${title}" style="max-width: 100%; border-radius: 12px; margin-top: 20px;">` : ''}
        </div>
        
        <div class="preview-section">
            ${content}
        </div>
    `;
    
    // Ajouter les sections modulaires
    if (window.pageContent.about.sections && window.pageContent.about.sections.length > 0) {
        window.pageContent.about.sections.forEach(section => {
            if (section.position === 'none') {
                previewHTML += `
                    <div class="preview-section">
                        <h2>${section.title}</h2>
                        <p>${section.content}</p>
                    </div>
                `;
            } else {
                previewHTML += `
                    <div class="preview-section">
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 40px; align-items: center; margin: 40px 0;">
                            ${section.position === 'left' ? `
                                ${section.image ? `<img src="${section.image}" alt="${section.title}" style="max-width: 100%; border-radius: 12px;">` : '<div style="background: var(--light); height: 200px; border-radius: 12px;"></div>'}
                                <div>
                                    <h2>${section.title}</h2>
                                    <p>${section.content}</p>
                                </div>
                            ` : `
                                <div>
                                    <h2>${section.title}</h2>
                                    <p>${section.content}</p>
                                </div>
                                ${section.image ? `<img src="${section.image}" alt="${section.title}" style="max-width: 100%; border-radius: 12px;">` : '<div style="background: var(--light); height: 200px; border-radius: 12px;"></div>'}
                            `}
                        </div>
                    </div>
                `;
            }
        });
    }
    
    // Ajouter les fonctionnalitÃ©s
    if (window.pageContent.about.features && window.pageContent.about.features.length > 0) {
        previewHTML += `
            <div class="preview-section">
                <h2 style="text-align: center; margin-bottom: 40px;">Pourquoi Nous Choisir ?</h2>
                <div class="preview-features">
                    ${window.pageContent.about.features.map(feature => `
                        <div class="preview-feature">
                            <div class="preview-feature-icon">
                                <i class="${feature.icon}"></i>
                            </div>
                            <h4>${feature.title}</h4>
                            <p>${feature.description}</p>
                        </div>
                    `).join('')}
                </div>
            </div>
        `;
    }
    
    return previewHTML;
}

function updateAboutPreview() {
    const previewContent = document.getElementById('aboutPreviewContent');
    if (previewContent) {
        previewContent.innerHTML = generateAboutPreview();
    }
}

// SAUVEGARDE AUTOMATIQUE
function startAutoSave(type) {
    let saveTimeout;
    const saveStatus = document.getElementById(`${type}SaveStatus`);
    
    const elements = document.querySelectorAll(`#edit${type.charAt(0).toUpperCase() + type.slice(1)}Form input, 
                                               #edit${type.charAt(0).toUpperCase() + type.slice(1)}Form textarea, 
                                               #edit${type.charAt(0).toUpperCase() + type.slice(1)}Form select,
                                               #${type}ContentEditor`);
    
    elements.forEach(element => {
        element.addEventListener('input', () => {
            if (saveTimeout) clearTimeout(saveTimeout);
            
            saveStatus.innerHTML = '<i class="fas fa-sync-alt fa-spin"></i> Sauvegarde...';
            saveStatus.className = 'save-status saving';
            
            saveTimeout = setTimeout(() => {
                savePageContentDraft(type);
                saveStatus.innerHTML = '<i class="fas fa-check-circle"></i> SauvegardÃ©';
                saveStatus.className = 'save-status saved';
            }, 1000);
        });
    });
}

function savePageContentDraft(type) {
    if (type === 'about') {
        const aboutData = {
            title: document.getElementById('aboutTitle')?.value || '',
            subtitle: document.getElementById('aboutSubtitle')?.value || '',
            content: document.getElementById('aboutContentEditor')?.innerHTML || '',
            image: document.getElementById('aboutImageUrl')?.value || '',
            sections: window.pageContent.about.sections || [],
            features: window.pageContent.about.features || []
        };
        
        // Sauvegarder le brouillon dans le localStorage
        localStorage.setItem('ldOrganicsAboutDraft', JSON.stringify(aboutData));
    }
}

// FONCTION DE SAUVEGARDE FINALE AMÃLIORÃE
function saveAboutContent() {
    const title = document.getElementById('aboutTitle').value;
    const subtitle = document.getElementById('aboutSubtitle').value;
    const content = document.getElementById('aboutContentEditor').innerHTML;
    const image = document.getElementById('aboutImageUrl').value;
    
    window.pageContent.about = {
        title: title,
        subtitle: subtitle,
        content: content,
        image: image,
        sections: window.pageContent.about.sections || [],
        features: window.pageContent.about.features || [],
        lastModified: new Date().toISOString()
    };
    
    savePageContent();
    
    // Supprimer le brouillon
    localStorage.removeItem('ldOrganicsAboutDraft');
    
    showNotification('Page "Ã propos" sauvegardÃ©e avec succÃ¨s !', 'success');
    closeCustomAlert();
    
    // Recharger le contenu si la page est actuellement affichÃ©e
    if (document.getElementById('about').style.display === 'block') {
        loadAboutContent();
    }
}

function resetAboutContent() {
    if (confirm('Ãtes-vous sÃ»r de vouloir restaurer le contenu par dÃ©faut ? Toutes les modifications non sauvegardÃ©es seront perdues.')) {
        window.pageContent.about = {
            ...defaultPageContent.about,
            sections: defaultPageContent.about.sections || [],
            features: defaultPageContent.about.features || []
        };
        
        // Supprimer les brouillons
        localStorage.removeItem('ldOrganicsAboutDraft');
        
        savePageContent();
        showNotification('Contenu "Ã propos" restaurÃ© avec succÃ¨s !', 'success');
        closeCustomAlert();
        
        if (document.getElementById('about').style.display === 'block') {
            loadAboutContent();
        }
    }
}

// FONCTION POUR L'ÃDITEUR CONTACT (version basique)
function showEditContactForm() {
    const modalContent = document.createElement('div');
    modalContent.className = 'modal-content content-editor';
    modalContent.innerHTML = `
        <div class="modal-header">
            <h2><i class="fas fa-edit"></i> Modifier la page "Contact"</h2>
            <button class="close-modal" onclick="closeCustomAlert()">&times;</button>
        </div>
        
        <form id="editContactForm">
            <div class="editor-section">
                <div class="editor-section-header">
                    <h4><i class="fas fa-heading"></i> Informations de base</h4>
                </div>
                <div class="grid-editor">
                    <div class="editor-field">
                        <label for="contactTitle">Titre de la page</label>
                        <input type="text" id="contactTitle" value="${window.pageContent.contact.title || defaultPageContent.contact.title}" required>
                    </div>
                    <div class="editor-field">
                        <label for="contactSubtitle">Sous-titre</label>
                        <input type="text" id="contactSubtitle" value="${window.pageContent.contact.subtitle || defaultPageContent.contact.subtitle}">
                    </div>
                </div>
            </div>

            <div class="editor-section">
                <div class="editor-section-header">
                    <h4><i class="fas fa-align-left"></i> Contenu de la page</h4>
                </div>
                <div class="editor-field">
                    <label for="contactContent">Contenu</label>
                    <textarea id="contactContent" rows="10">${window.pageContent.contact.content || defaultPageContent.contact.content}</textarea>
                </div>
            </div>

            <div class="editor-actions">
                <button type="button" class="admin-btn primary" onclick="saveContactContent()">
                    <i class="fas fa-save"></i> Sauvegarder
                </button>
                <button type="button" class="admin-btn secondary" onclick="closeCustomAlert()">
                    <i class="fas fa-times"></i> Annuler
                </button>
                <button type="button" class="admin-btn warning" onclick="resetContactContent()">
                    <i class="fas fa-undo"></i> Restaurer les valeurs par dÃ©faut
                </button>
            </div>
        </form>
    `;
    
    showCustomAlert(modalContent);
}

function saveContactContent() {
    const title = document.getElementById('contactTitle').value;
    const subtitle = document.getElementById('contactSubtitle').value;
    const content = document.getElementById('contactContent').value;
    
    window.pageContent.contact = {
        title: title,
        subtitle: subtitle,
        content: content
    };
    
    savePageContent();
    showNotification('Page "Contact" modifiÃ©e avec succÃ¨s !', 'success');
    closeCustomAlert();
    
    // Recharger le contenu si la page est actuellement affichÃ©e
    if (document.getElementById('contact').style.display === 'block') {
        loadContactContent();
    }
}

function resetContactContent() {
    if (confirm('Ãtes-vous sÃ»r de vouloir restaurer le contenu par dÃ©faut de la page "Contact" ?')) {
        window.pageContent.contact = {...defaultPageContent.contact};
        savePageContent();
        showNotification('Contenu "Contact" restaurÃ© avec succÃ¨s !', 'success');
        closeCustomAlert();
        
        if (document.getElementById('contact').style.display === 'block') {
            loadContactContent();
        }
    }
}

// =============================================
// INITIALISATION FINALE
// =============================================

// Lancer l'initialisation au chargement
document.addEventListener('DOMContentLoaded', function() {
    console.log('ð¦ Chargement de l application LD Organics');
    initializeApplication();
    
    // Sauvegarde automatique
    window.addEventListener('beforeunload', function() {
        saveAllData();
        savePageContent();
    });
    
    setInterval(function() {
        if (window.products.length > 0 || window.users.length > 0 || window.orders.length > 0) {
            saveAllData();
        }
    }, 30000); // Sauvegarde toutes les 30 secondes
});
</script>
</body>
</html>